query_id,category,natural_language_query,ground_truth_sql
Q0001,Simple Retrieval,List all companies classified under the Consumer Cyclical sector.,"SELECT name, symbol FROM companies WHERE sector = 'Consumer Cyclical' ORDER BY name ASC;"
Q0002,Nested/Complex Logic,Find the percentage contribution of each Energy company's Profit Margin to the total sector Profit Margin.,"SELECT c.name, (fs.profit_margin * 100.0 / SUM(fs.profit_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0003,Multi-table Join,"Show me Technology companies, their ESG scores, and their dividend yields.","SELECT c.name, esg.total_score, fm.dividend_yield FROM companies c JOIN esg_scores esg ON c.symbol = esg.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Technology';"
Q0004,Temporal Filtering,Fetch the maximum daily trading volume for TMO over the past 7 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'TMO' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0005,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Comcast.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'CMCSA' AND date = CURRENT_DATE;
Q0006,Aggregation,Determine the median bottom line for companies within the Consumer Cyclical sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY net_income) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0007,Multi-table Join,"Fetch the names, ticker symbols, and current Quick Ratio for all Healthcare companies.","SELECT c.name, c.symbol, fm.quick_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0008,Nested/Complex Logic,Find Communication Services companies whose Total Assets is strictly greater than the sector's average Total Assets.,"WITH SectorAvg AS (SELECT AVG(total_assets) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.total_assets FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.total_assets > sa.avg_val;"
Q0009,Simple Retrieval,Can you find the headquarters location for Thermo Fisher.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'TMO';"
Q0010,Simple Retrieval,How many employees work at Coca-Cola?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'KO';
Q0011,Aggregation,Calculate the standard deviation of P/E Ratio for Financials stocks.,SELECT STDDEV(pe_ratio) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0012,Temporal Filtering,Show the historical trajectory of Disney's closing prices in the year 2021.,"SELECT date, close FROM stock_prices WHERE symbol = 'DIS' AND year = 2021 ORDER BY date ASC;"
Q0013,Multi-table Join,"Retrieve the names, ticker symbols, and current Profit Margin for all Technology companies.","SELECT c.name, c.symbol, fm.profit_margin FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Technology' AND fm.date = CURRENT_DATE;"
Q0014,Nested/Complex Logic,Find Consumer Defensive companies whose Beta is strictly greater than the sector's average Beta.,"WITH SectorAvg AS (SELECT AVG(beta) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.beta FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.beta > sa.avg_val;"
Q0015,Nested/Complex Logic,Find the percentage contribution of each Financials company's Revenue to the total sector Revenue.,"SELECT c.name, (fs.revenue * 100.0 / SUM(fs.revenue) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0016,Simple Retrieval,When did Amazon go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'AMZN';
Q0017,Multi-table Join,Generate a report showing the closing prices and latest Net Income for companies in the Energy sector.,"SELECT c.name, sp.close, fs.net_income FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0018,Multi-table Join,"Extract the names, ticker symbols, and current ROE for all Energy companies.","SELECT c.name, c.symbol, fm.roe FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Energy' AND fm.date = CURRENT_DATE;"
Q0019,Multi-table Join,"Can you find the names, ticker symbols, and current EPS for all Consumer Defensive companies.","SELECT c.name, c.symbol, fm.eps FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Defensive' AND fm.date = CURRENT_DATE;"
Q0020,Multi-table Join,"List the top 20 Communication Services stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Communication Services' ORDER BY c.market_cap DESC LIMIT 20;"
Q0021,Multi-table Join,"List the top 15 Energy stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Energy' ORDER BY c.market_cap DESC LIMIT 15;"
Q0022,Temporal Filtering,Did Nvidia report a positive return on equity TTM?,SELECT CASE WHEN roe > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'NVDA' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0023,Temporal Filtering,Show the historical trajectory of PepsiCo's closing prices over the past 7 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'PEP' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date ASC;"
Q0024,Multi-table Join,"List the top 5 Financials stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Financials' ORDER BY c.market_cap DESC LIMIT 5;"
Q0025,Temporal Filtering,Identify the Gross Margin for Berkshire Hathaway during the last 30 days?,SELECT gross_margin FROM financial_statements WHERE symbol = 'BRK.B' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0026,Simple Retrieval,Who is the Chief Executive Officer of Wells Fargo?,SELECT ceo_name FROM company_profiles WHERE symbol = 'WFC';
Q0027,Multi-table Join,"Identify the names, ticker symbols, and current Dividend Yield for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.dividend_yield FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0028,Multi-table Join,Join company profiles with stock performance to find Energy stock returns year-to-date.,"SELECT c.name, (sp_curr.close - sp_start.close)/sp_start.close as ytd_return FROM companies c JOIN stock_prices sp_curr ON c.symbol = sp_curr.symbol JOIN stock_prices sp_start ON c.symbol = sp_start.symbol WHERE c.sector = 'Energy' AND sp_curr.date = CURRENT_DATE AND sp_start.date = DATE_TRUNC('year', CURRENT_DATE);"
Q0029,Aggregation,Count the number of stocks where the Revenue exceeds 5.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE revenue > 5;
Q0030,Multi-table Join,"Fetch the names, ticker symbols, and current Dividend Yield for all Communication Services companies.","SELECT c.name, c.symbol, fm.dividend_yield FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0031,Temporal Filtering,Show the historical trajectory of Nike's closing prices for the full fiscal year 2023.,"SELECT date, close FROM stock_prices WHERE symbol = 'NKE' AND period = 'FY' AND year = 2023 ORDER BY date ASC;"
Q0032,Aggregation,Count the number of stocks where the Free Cash Flow exceeds 10.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE free_cash_flow > 10;
Q0033,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.77 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.77 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0034,Temporal Filtering,Did Thermo Fisher report a positive D/E ratio over the past 7 days?,SELECT CASE WHEN debt_to_equity > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'TMO' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0035,Nested/Complex Logic,Find the percentage contribution of each Communication Services company's ROI to the total sector ROI.,"SELECT c.name, (fs.roi * 100.0 / SUM(fs.roi) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0036,Temporal Filtering,Query the maximum daily trading volume for ABBV YTD.,"SELECT MAX(volume) FROM stock_prices WHERE symbol = 'ABBV' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0037,Aggregation,What is the total sum of alpha for the Technology sector?,SELECT SUM(fs.alpha) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0038,Temporal Filtering,Find the specific date when Microsoft hit its highest price during the fourth quarter of 2022.,SELECT date FROM stock_prices WHERE symbol = 'MSFT' AND period = 'Q4' AND year = 2022 ORDER BY high DESC LIMIT 1;
Q0039,Nested/Complex Logic,Find Communication Services companies whose Quick Ratio is strictly greater than the sector's average Quick Ratio.,"WITH SectorAvg AS (SELECT AVG(quick_ratio) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.quick_ratio FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.quick_ratio > sa.avg_val;"
Q0040,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 0.99%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (0.99/100.0) AND fm.date = CURRENT_DATE;
Q0041,Simple Retrieval,Identify Nvidia's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'NVDA';"
Q0042,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Current Ratio.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.current_ratio > (SELECT AVG(current_ratio) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0043,Aggregation,Calculate the standard deviation of ROE for Healthcare stocks.,SELECT STDDEV(roe) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0044,Temporal Filtering,Show me the Quick Ratio for Amgen in the year 2021?,SELECT quick_ratio FROM financial_statements WHERE symbol = 'AMGN' AND year = 2021;
Q0045,Aggregation,Determine the median yield for companies within the Financials sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY dividend_yield) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials';
Q0046,Multi-table Join,"List the top 5 Energy stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Energy' ORDER BY c.market_cap DESC LIMIT 5;"
Q0047,Aggregation,Count the number of stocks where the Operating Margin exceeds 40.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE operating_margin > 40;
Q0048,Simple Retrieval,How many employees work at Philip Morris?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'PM';
Q0049,Simple Retrieval,How many employees work at Broadcom?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'AVGO';
Q0050,Nested/Complex Logic,Find the percentage contribution of each Financials company's Profit Margin to the total sector Profit Margin.,"SELECT c.name, (fs.profit_margin * 100.0 / SUM(fs.profit_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0051,Multi-table Join,"List the top 15 Healthcare stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Healthcare' ORDER BY c.market_cap DESC LIMIT 15;"
Q0052,Multi-table Join,Retrieve the closing prices and latest ROA for companies in the Energy sector.,"SELECT c.name, sp.close, fs.roa FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0053,Temporal Filtering,Did Texas Instruments report a positive liquidity ratio YTD?,"SELECT CASE WHEN current_ratio > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'TXN' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0054,Multi-table Join,"I need the names, ticker symbols, and current EPS for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.eps FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0055,Aggregation,Calculate the standard deviation of Total Liabilities for Consumer Defensive stocks.,SELECT STDDEV(total_liabilities) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Defensive';
Q0056,Multi-table Join,"List the top 50 Technology stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Technology' ORDER BY c.market_cap DESC LIMIT 50;"
Q0057,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Walmart.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'WMT' AND date = CURRENT_DATE;
Q0058,Aggregation,Calculate the average dividend yield across all Energy companies.,SELECT AVG(fm.dividend_yield) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0059,Aggregation,Calculate the standard deviation of Gross Margin for Energy stocks.,SELECT STDDEV(gross_margin) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0060,Simple Retrieval,Who is the Chief Executive Officer of Johnson & Johnson?,SELECT ceo_name FROM company_profiles WHERE symbol = 'JNJ';
Q0061,Multi-table Join,Look up the closing prices and latest EBITDA for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.ebitda FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0062,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 0.68%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (0.68/100.0) AND fm.date = CURRENT_DATE;
Q0063,Simple Retrieval,Identify Disney's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'DIS';"
Q0064,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.84 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.84 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0065,Temporal Filtering,Show the historical trajectory of Exxon Mobil's closing prices YTD.,"SELECT date, close FROM stock_prices WHERE symbol = 'XOM' AND date >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY date ASC;"
Q0066,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.67 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.67 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0067,Multi-table Join,"Return the names, ticker symbols, and current ROA for all Financials companies.","SELECT c.name, c.symbol, fm.roa FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0068,Temporal Filtering,Please display the Free Cash Flow for Cisco in the year 2021?,SELECT free_cash_flow FROM financial_statements WHERE symbol = 'CSCO' AND year = 2021;
Q0069,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Chevron.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'CVX' AND date = CURRENT_DATE;
Q0070,Nested/Complex Logic,Identify the single company with the highest EBITDA across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.ebitda, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.ebitda DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, ebitda FROM RankedData WHERE rank_id = 1;"
Q0071,Simple Retrieval,Who is the Chief Executive Officer of Costco?,SELECT ceo_name FROM company_profiles WHERE symbol = 'COST';
Q0072,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 4.02 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 4.02 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0073,Nested/Complex Logic,Show Communication Services stocks exhibiting aggressive growth where this year's Dividend Yield exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Communication Services' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.dividend_yield > (prev.dividend_yield * 1.20);
Q0074,Temporal Filtering,Did Disney report a positive D/E ratio in the first quarter of last year?,SELECT CASE WHEN debt_to_equity > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'DIS' AND period = 'Q1' AND year = 2023;
Q0075,Nested/Complex Logic,Find Consumer Defensive companies whose P/E Ratio is strictly greater than the sector's average P/E Ratio.,"WITH SectorAvg AS (SELECT AVG(pe_ratio) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.pe_ratio FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.pe_ratio > sa.avg_val;"
Q0076,Multi-table Join,"Calculate the names, ticker symbols, and current Beta for all Communication Services companies.","SELECT c.name, c.symbol, fm.beta FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0077,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Berkshire Hathaway.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'BRK.B' AND date = CURRENT_DATE;
Q0078,Simple Retrieval,Who is the Chief Executive Officer of Mastercard?,SELECT ceo_name FROM company_profiles WHERE symbol = 'MA';
Q0079,Aggregation,What is the total sum of forward p/e for the Healthcare sector?,SELECT SUM(fs.forward_pe) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0080,Multi-table Join,"List the top 20 Consumer Cyclical stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Cyclical' ORDER BY c.market_cap DESC LIMIT 20;"
Q0081,Aggregation,Calculate the average revenue across all Energy companies.,SELECT AVG(fm.revenue) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0082,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.97 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.97 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0083,Temporal Filtering,Did Coca-Cola report a positive net margin over the past 7 days?,SELECT CASE WHEN profit_margin > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'KO' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0084,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's Profit Margin to the total sector Profit Margin.,"SELECT c.name, (fs.profit_margin * 100.0 / SUM(fs.profit_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0085,Multi-table Join,"Identify the names, ticker symbols, and current Revenue for all Communication Services companies.","SELECT c.name, c.symbol, fm.revenue FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0086,Aggregation,Calculate the average forward p/e across all Consumer Cyclical companies.,SELECT AVG(fm.forward_pe) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0087,Aggregation,Count the number of stocks where the Current Ratio exceeds 30.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE current_ratio > 30;
Q0088,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 20 Communication Services market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 20;"
Q0089,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.45%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.45/100.0) AND fm.date = CURRENT_DATE;
Q0090,Nested/Complex Logic,Find the percentage contribution of each Financials company's ROA to the total sector ROA.,"SELECT c.name, (fs.roa * 100.0 / SUM(fs.roa) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0091,Nested/Complex Logic,Find Consumer Cyclical companies whose Revenue is strictly greater than the sector's average Revenue.,"WITH SectorAvg AS (SELECT AVG(revenue) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.revenue FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.revenue > sa.avg_val;"
Q0092,Temporal Filtering,Generate a report showing the maximum daily trading volume for HD over the past 7 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'HD' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0093,Simple Retrieval,List the headquarters location for Abbott Labs.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'ABT';"
Q0094,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Cisco.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'CSCO' AND date = CURRENT_DATE;
Q0095,Multi-table Join,"List the top 50 Energy stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Energy' ORDER BY c.market_cap DESC LIMIT 50;"
Q0096,Aggregation,Calculate the average revenue across all Communication Services companies.,SELECT AVG(fm.revenue) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0097,Multi-table Join,"List the top 15 Consumer Defensive stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Defensive' ORDER BY c.market_cap DESC LIMIT 15;"
Q0098,Aggregation,Count the number of stocks where the Payout Ratio exceeds 20.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE payout_ratio > 20;
Q0099,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 50 Healthcare market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 50;"
Q0100,Simple Retrieval,Determine the headquarters location for AbbVie.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'ABBV';"
Q0101,Simple Retrieval,Return the ticker symbol associated with Coca-Cola.,SELECT symbol FROM companies WHERE name ILIKE 'Coca-Cola%';
Q0102,Simple Retrieval,Get the official company website for PEP.,SELECT website_url FROM company_profiles WHERE symbol = 'PEP';
Q0103,Multi-table Join,Calculate the closing prices and latest Revenue for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.revenue FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0104,Simple Retrieval,How many employees work at Abbott Labs?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'ABT';
Q0105,Temporal Filtering,Find the specific date when Eli Lilly hit its highest price during the fourth quarter of 2022.,SELECT date FROM stock_prices WHERE symbol = 'LLY' AND period = 'Q4' AND year = 2022 ORDER BY high DESC LIMIT 1;
Q0106,Temporal Filtering,Find the specific date when Procter & Gamble hit its highest price TTM.,SELECT date FROM stock_prices WHERE symbol = 'PG' AND date >= CURRENT_DATE - INTERVAL '1 year' ORDER BY high DESC LIMIT 1;
Q0107,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.75 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.75 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0108,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Thermo Fisher.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'TMO' AND date = CURRENT_DATE;
Q0109,Aggregation,Calculate the standard deviation of Revenue for Healthcare stocks.,SELECT STDDEV(revenue) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0110,Multi-table Join,Determine the closing prices and latest Alpha for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.alpha FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0111,Aggregation,Determine the median total debt for companies within the Consumer Defensive sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_liabilities) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive';
Q0112,Nested/Complex Logic,Find the percentage contribution of each Energy company's Forward P/E to the total sector Forward P/E.,"SELECT c.name, (fs.forward_pe * 100.0 / SUM(fs.forward_pe) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0113,Nested/Complex Logic,Show Communication Services stocks exhibiting aggressive growth where this year's P/E Ratio exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Communication Services' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.pe_ratio > (prev.pe_ratio * 1.20);
Q0114,Simple Retrieval,Identify Exxon Mobil's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'XOM';"
Q0115,Aggregation,Calculate the average forward p/e across all Financials companies.,SELECT AVG(fm.forward_pe) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0116,Nested/Complex Logic,Find Energy companies whose Alpha is strictly greater than the sector's average Alpha.,"WITH SectorAvg AS (SELECT AVG(alpha) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.alpha FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.alpha > sa.avg_val;"
Q0117,Simple Retrieval,Identify the closing stock price for Microsoft?,SELECT close FROM stock_prices WHERE symbol = 'MSFT' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'MSFT');
Q0118,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.73 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.73 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0119,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 3 Consumer Defensive market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 3;"
Q0120,Simple Retrieval,Identify UnitedHealth's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'UNH';"
Q0121,Aggregation,Count the number of stocks where the Alpha exceeds 40.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE alpha > 40;
Q0122,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 50 Consumer Cyclical market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 50;"
Q0123,Simple Retrieval,Who is the Chief Executive Officer of UnitedHealth?,SELECT ceo_name FROM company_profiles WHERE symbol = 'UNH';
Q0124,Temporal Filtering,Retrieve the maximum daily trading volume for MA during the fourth quarter of 2022.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'MA' AND period = 'Q4' AND year = 2022;
Q0125,Multi-table Join,Generate a report showing the closing prices and latest Net Income for companies in the Financials sector.,"SELECT c.name, sp.close, fs.net_income FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0126,Nested/Complex Logic,Show Consumer Cyclical stocks exhibiting aggressive growth where this year's ROA exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.roa > (prev.roa * 1.20);
Q0127,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Coca-Cola.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'KO' AND date = CURRENT_DATE;
Q0128,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Forward P/E.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.forward_pe > (SELECT AVG(forward_pe) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0129,Nested/Complex Logic,Find the percentage contribution of each Communication Services company's Free Cash Flow to the total sector Free Cash Flow.,"SELECT c.name, (fs.free_cash_flow * 100.0 / SUM(fs.free_cash_flow) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0130,Temporal Filtering,Did Disney report a positive excess return over the past 7 days?,SELECT CASE WHEN alpha > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'DIS' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0131,Multi-table Join,"What is the names, ticker symbols, and current Revenue for all Energy companies.","SELECT c.name, c.symbol, fm.revenue FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Energy' AND fm.date = CURRENT_DATE;"
Q0132,Temporal Filtering,Find the specific date when Tesla hit its highest price in the first quarter of last year.,SELECT date FROM stock_prices WHERE symbol = 'TSLA' AND period = 'Q1' AND year = 2023 ORDER BY high DESC LIMIT 1;
Q0133,Temporal Filtering,I'd like to see the Total Assets for Tesla TTM?,SELECT total_assets FROM financial_statements WHERE symbol = 'TSLA' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0134,Nested/Complex Logic,Identify the single company with the highest Profit Margin across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.profit_margin, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.profit_margin DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, profit_margin FROM RankedData WHERE rank_id = 1;"
Q0135,Temporal Filtering,Show the historical trajectory of Verizon's closing prices in the first quarter of last year.,"SELECT date, close FROM stock_prices WHERE symbol = 'VZ' AND period = 'Q1' AND year = 2023 ORDER BY date ASC;"
Q0136,Aggregation,Calculate the average roi across all Consumer Cyclical companies.,SELECT AVG(fm.roi) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0137,Multi-table Join,"Show me Healthcare companies, their ESG scores, and their dividend yields.","SELECT c.name, esg.total_score, fm.dividend_yield FROM companies c JOIN esg_scores esg ON c.symbol = esg.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare';"
Q0138,Multi-table Join,Retrieve the closing prices and latest ROE for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.roe FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0139,Temporal Filtering,Could you provide the Current Ratio for Abbott Labs in the first quarter of last year?,SELECT current_ratio FROM financial_statements WHERE symbol = 'ABT' AND period = 'Q1' AND year = 2023;
Q0140,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.41%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.41/100.0) AND fm.date = CURRENT_DATE;
Q0141,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.24 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.24 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0142,Nested/Complex Logic,Find the percentage contribution of each Technology company's ROI to the total sector ROI.,"SELECT c.name, (fs.roi * 100.0 / SUM(fs.roi) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0143,Aggregation,Count the number of stocks where the Profit Margin exceeds 50.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE profit_margin > 50;
Q0144,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.66%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.66/100.0) AND fm.date = CURRENT_DATE;
Q0145,Multi-table Join,I'd like to see the closing prices and latest P/E Ratio for companies in the Financials sector.,"SELECT c.name, sp.close, fs.pe_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0146,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.07%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.07/100.0) AND fm.date = CURRENT_DATE;
Q0147,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 5 Technology market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 5;"
Q0148,Nested/Complex Logic,Show Communication Services stocks exhibiting aggressive growth where this year's Free Cash Flow exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Communication Services' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.free_cash_flow > (prev.free_cash_flow * 1.20);
Q0149,Nested/Complex Logic,Show Financials stocks exhibiting aggressive growth where this year's Total Liabilities exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Financials' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.total_liabilities > (prev.total_liabilities * 1.20);
Q0150,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.08%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.08/100.0) AND fm.date = CURRENT_DATE;
Q0151,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 20 Healthcare market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 20;"
Q0152,Nested/Complex Logic,Show Energy stocks exhibiting aggressive growth where this year's P/E Ratio exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Energy' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.pe_ratio > (prev.pe_ratio * 1.20);
Q0153,Aggregation,Count the number of stocks where the Current Ratio exceeds 10.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE current_ratio > 10;
Q0154,Simple Retrieval,What is the market capitalization of MSFT.,SELECT market_cap FROM companies WHERE symbol = 'MSFT';
Q0155,Aggregation,Determine the median operating income margin for companies within the Technology sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY operating_margin) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology';
Q0156,Multi-table Join,"List the top 50 Financials stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Financials' ORDER BY c.market_cap DESC LIMIT 50;"
Q0157,Multi-table Join,Retrieve the closing prices and latest Gross Margin for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.gross_margin FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0158,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 0.57%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (0.57/100.0) AND fm.date = CURRENT_DATE;
Q0159,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.4 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.4 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0160,Temporal Filtering,Return the Beta for Merck YTD?,"SELECT beta FROM financial_statements WHERE symbol = 'MRK' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0161,Simple Retrieval,Identify Meta Platforms's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'META';"
Q0162,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.35 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.35 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0163,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Free Cash Flow exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.free_cash_flow > (prev.free_cash_flow * 1.20);
Q0164,Multi-table Join,Calculate the closing prices and latest Dividend Yield for companies in the Technology sector.,"SELECT c.name, sp.close, fs.dividend_yield FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0165,Aggregation,What is the total sum of forward p/e for the Consumer Defensive sector?,SELECT SUM(fs.forward_pe) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0166,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Profit Margin exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.profit_margin > (prev.profit_margin * 1.20);
Q0167,Aggregation,Count the number of stocks where the Profit Margin exceeds 5.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE profit_margin > 5;
Q0168,Temporal Filtering,Did Procter & Gamble report a positive excess return during the fourth quarter of 2022?,SELECT CASE WHEN alpha > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'PG' AND period = 'Q4' AND year = 2022;
Q0169,Simple Retrieval,How many employees work at Bank of America?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'BAC';
Q0170,Nested/Complex Logic,Identify the single company with the highest Dividend Yield across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.dividend_yield, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.dividend_yield DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, dividend_yield FROM RankedData WHERE rank_id = 1;"
Q0171,Nested/Complex Logic,Show Consumer Defensive stocks exhibiting aggressive growth where this year's Profit Margin exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.profit_margin > (prev.profit_margin * 1.20);
Q0172,Temporal Filtering,Determine the Gross Margin for Amazon in the year 2021?,SELECT gross_margin FROM financial_statements WHERE symbol = 'AMZN' AND year = 2021;
Q0173,Multi-table Join,"List the top 15 Financials stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Financials' ORDER BY c.market_cap DESC LIMIT 15;"
Q0174,Multi-table Join,Identify the closing prices and latest Beta for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.beta FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0175,Temporal Filtering,Could you provide the Quick Ratio for Broadcom YTD?,"SELECT quick_ratio FROM financial_statements WHERE symbol = 'AVGO' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0176,Temporal Filtering,Show the historical trajectory of Nvidia's closing prices during the fourth quarter of 2022.,"SELECT date, close FROM stock_prices WHERE symbol = 'NVDA' AND period = 'Q4' AND year = 2022 ORDER BY date ASC;"
Q0177,Simple Retrieval,Who is the Chief Executive Officer of Tesla?,SELECT ceo_name FROM company_profiles WHERE symbol = 'TSLA';
Q0178,Temporal Filtering,Find the specific date when Abbott Labs hit its highest price TTM.,SELECT date FROM stock_prices WHERE symbol = 'ABT' AND date >= CURRENT_DATE - INTERVAL '1 year' ORDER BY high DESC LIMIT 1;
Q0179,Simple Retrieval,When did JPMorgan Chase go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'JPM';
Q0180,Multi-table Join,Join company profiles with stock performance to find Consumer Defensive stock returns year-to-date.,"SELECT c.name, (sp_curr.close - sp_start.close)/sp_start.close as ytd_return FROM companies c JOIN stock_prices sp_curr ON c.symbol = sp_curr.symbol JOIN stock_prices sp_start ON c.symbol = sp_start.symbol WHERE c.sector = 'Consumer Defensive' AND sp_curr.date = CURRENT_DATE AND sp_start.date = DATE_TRUNC('year', CURRENT_DATE);"
Q0181,Aggregation,Determine the maximum recorded stock price in the Technology sector today.,SELECT MAX(sp.high) as max_price FROM stock_prices sp JOIN companies c ON sp.symbol = c.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE;
Q0182,Multi-table Join,"List the top 3 Consumer Cyclical stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Cyclical' ORDER BY c.market_cap DESC LIMIT 3;"
Q0183,Simple Retrieval,How many employees work at Tesla?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'TSLA';
Q0184,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.5%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.5/100.0) AND fm.date = CURRENT_DATE;
Q0185,Simple Retrieval,Show me the official company website for DIS.,SELECT website_url FROM company_profiles WHERE symbol = 'DIS';
Q0186,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.06 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.06 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0187,Simple Retrieval,How many employees work at Alphabet?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'GOOG';
Q0188,Temporal Filtering,Show the historical trajectory of Accenture's closing prices for the full fiscal year 2023.,"SELECT date, close FROM stock_prices WHERE symbol = 'ACN' AND period = 'FY' AND year = 2023 ORDER BY date ASC;"
Q0189,Multi-table Join,What is the closing prices and latest Net Income for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.net_income FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0190,Simple Retrieval,Get the headquarters location for Philip Morris.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'PM';"
Q0191,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.11 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.11 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0192,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.78%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.78/100.0) AND fm.date = CURRENT_DATE;
Q0193,Temporal Filtering,Show me the maximum daily trading volume for ACN TTM.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'ACN' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0194,Temporal Filtering,What is the Quick Ratio for Wells Fargo during the last 30 days?,SELECT quick_ratio FROM financial_statements WHERE symbol = 'WFC' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0195,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Beta.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.beta > (SELECT AVG(beta) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0196,Temporal Filtering,Identify the Profit Margin for Eli Lilly in the year 2021?,SELECT profit_margin FROM financial_statements WHERE symbol = 'LLY' AND year = 2021;
Q0197,Temporal Filtering,Determine the Payout Ratio for Danaher YTD?,"SELECT payout_ratio FROM financial_statements WHERE symbol = 'DHR' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0198,Nested/Complex Logic,Identify the single company with the highest Forward P/E across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.forward_pe, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.forward_pe DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, forward_pe FROM RankedData WHERE rank_id = 1;"
Q0199,Multi-table Join,Show me the closing prices and latest Free Cash Flow for companies in the Technology sector.,"SELECT c.name, sp.close, fs.free_cash_flow FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0200,Nested/Complex Logic,Find Consumer Cyclical companies whose Free Cash Flow is strictly greater than the sector's average Free Cash Flow.,"WITH SectorAvg AS (SELECT AVG(free_cash_flow) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.free_cash_flow FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.free_cash_flow > sa.avg_val;"
Q0201,Nested/Complex Logic,Find Consumer Cyclical companies whose ROA is strictly greater than the sector's average ROA.,"WITH SectorAvg AS (SELECT AVG(roa) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.roa FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.roa > sa.avg_val;"
Q0202,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.67%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.67/100.0) AND fm.date = CURRENT_DATE;
Q0203,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's Alpha to the total sector Alpha.,"SELECT c.name, (fs.alpha * 100.0 / SUM(fs.alpha) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0204,Aggregation,What is the total sum of current ratio for the Communication Services sector?,SELECT SUM(fs.current_ratio) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0205,Temporal Filtering,Show the historical trajectory of Verizon's closing prices over the past 7 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'VZ' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date ASC;"
Q0206,Temporal Filtering,Did Costco report a positive excess return in the year 2021?,SELECT CASE WHEN alpha > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'COST' AND year = 2021;
Q0207,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 20 Financials market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 20;"
Q0208,Aggregation,What is the total sum of p/e ratio for the Consumer Defensive sector?,SELECT SUM(fs.pe_ratio) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0209,Multi-table Join,"List the top 5 Healthcare stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Healthcare' ORDER BY c.market_cap DESC LIMIT 5;"
Q0210,Aggregation,Calculate the standard deviation of Gross Margin for Technology stocks.,SELECT STDDEV(gross_margin) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0211,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.88 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.88 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0212,Simple Retrieval,Look up the market capitalization of BAC.,SELECT market_cap FROM companies WHERE symbol = 'BAC';
Q0213,Nested/Complex Logic,Find Technology companies whose Revenue is strictly greater than the sector's average Revenue.,"WITH SectorAvg AS (SELECT AVG(revenue) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.revenue FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.revenue > sa.avg_val;"
Q0214,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average P/E Ratio.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.pe_ratio > (SELECT AVG(pe_ratio) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0215,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.92 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.92 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0216,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Costco.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'COST' AND date = CURRENT_DATE;
Q0217,Simple Retrieval,Can you find the market capitalization of DHR.,SELECT market_cap FROM companies WHERE symbol = 'DHR';
Q0218,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.82 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.82 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0219,Temporal Filtering,Return the Current Ratio for Cisco for the full fiscal year 2023?,SELECT current_ratio FROM financial_statements WHERE symbol = 'CSCO' AND period = 'FY' AND year = 2023;
Q0220,Simple Retrieval,Determine the headquarters location for Home Depot.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'HD';"
Q0221,Simple Retrieval,Identify Visa's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'V';"
Q0222,Nested/Complex Logic,Identify the single company with the highest ROA across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.roa, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.roa DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, roa FROM RankedData WHERE rank_id = 1;"
Q0223,Simple Retrieval,Show me the ticker symbol associated with Walmart.,SELECT symbol FROM companies WHERE name ILIKE 'Walmart%';
Q0224,Temporal Filtering,Find the specific date when Verizon hit its highest price in the year 2021.,SELECT date FROM stock_prices WHERE symbol = 'VZ' AND year = 2021 ORDER BY high DESC LIMIT 1;
Q0225,Simple Retrieval,Generate a report showing the ticker symbol associated with JPMorgan Chase.,SELECT symbol FROM companies WHERE name ILIKE 'JPMorgan Chase%';
Q0226,Aggregation,What is the total sum of quick ratio for the Technology sector?,SELECT SUM(fs.quick_ratio) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0227,Aggregation,Determine the median yield for companies within the Technology sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY dividend_yield) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology';
Q0228,Temporal Filtering,Generate a report showing the Free Cash Flow for McDonald's during the fourth quarter of 2022?,SELECT free_cash_flow FROM financial_statements WHERE symbol = 'MCD' AND period = 'Q4' AND year = 2022;
Q0229,Multi-table Join,I need the closing prices and latest Forward P/E for companies in the Energy sector.,"SELECT c.name, sp.close, fs.forward_pe FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0230,Temporal Filtering,I need the Debt-to-Equity for Texas Instruments during the fourth quarter of 2022?,SELECT debt_to_equity FROM financial_statements WHERE symbol = 'TXN' AND period = 'Q4' AND year = 2022;
Q0231,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.98 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.98 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0232,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.99 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.99 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0233,Temporal Filtering,Did Comcast report a positive bottom line during the last 30 days?,SELECT CASE WHEN net_income > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'CMCSA' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0234,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Alpha.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.alpha > (SELECT AVG(alpha) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0235,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 10 Consumer Cyclical market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 10;"
Q0236,Aggregation,Calculate the average eps across all Healthcare companies.,SELECT AVG(fm.eps) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0237,Simple Retrieval,Identify Texas Instruments's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'TXN';"
Q0238,Simple Retrieval,List all companies classified under the Consumer Defensive sector.,"SELECT name, symbol FROM companies WHERE sector = 'Consumer Defensive' ORDER BY name ASC;"
Q0239,Aggregation,Calculate the standard deviation of Dividend Yield for Communication Services stocks.,SELECT STDDEV(dividend_yield) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0240,Temporal Filtering,Determine the maximum daily trading volume for AAPL during the fourth quarter of 2022.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'AAPL' AND period = 'Q4' AND year = 2022;
Q0241,Nested/Complex Logic,Show Technology stocks exhibiting aggressive growth where this year's Free Cash Flow exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Technology' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.free_cash_flow > (prev.free_cash_flow * 1.20);
Q0242,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 15 Energy market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 15;"
Q0243,Simple Retrieval,How many employees work at Berkshire Hathaway?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'BRK.B';
Q0244,Multi-table Join,What is the closing prices and latest Dividend Yield for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.dividend_yield FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0245,Temporal Filtering,Find the specific date when Verizon hit its highest price during the fourth quarter of 2022.,SELECT date FROM stock_prices WHERE symbol = 'VZ' AND period = 'Q4' AND year = 2022 ORDER BY high DESC LIMIT 1;
Q0246,Aggregation,Count the number of stocks where the Current Ratio exceeds 40.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE current_ratio > 40;
Q0247,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.11%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.11/100.0) AND fm.date = CURRENT_DATE;
Q0248,Nested/Complex Logic,Find Consumer Cyclical companies whose Payout Ratio is strictly greater than the sector's average Payout Ratio.,"WITH SectorAvg AS (SELECT AVG(payout_ratio) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.payout_ratio FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.payout_ratio > sa.avg_val;"
Q0249,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.8%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.8/100.0) AND fm.date = CURRENT_DATE;
Q0250,Nested/Complex Logic,Show Consumer Cyclical stocks exhibiting aggressive growth where this year's EPS exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.eps > (prev.eps * 1.20);
Q0251,Aggregation,Count the number of stocks where the P/E Ratio exceeds 5.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE pe_ratio > 5;
Q0252,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 5 Consumer Defensive market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 5;"
Q0253,Multi-table Join,Determine the closing prices and latest Payout Ratio for companies in the Technology sector.,"SELECT c.name, sp.close, fs.payout_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0254,Simple Retrieval,Return the market capitalization of ABBV.,SELECT market_cap FROM companies WHERE symbol = 'ABBV';
Q0255,Temporal Filtering,Show the historical trajectory of UnitedHealth's closing prices in the year 2021.,"SELECT date, close FROM stock_prices WHERE symbol = 'UNH' AND year = 2021 ORDER BY date ASC;"
Q0256,Nested/Complex Logic,Show Consumer Cyclical stocks exhibiting aggressive growth where this year's Debt-to-Equity exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.debt_to_equity > (prev.debt_to_equity * 1.20);
Q0257,Aggregation,Calculate the average roe across all Consumer Cyclical companies.,SELECT AVG(fm.roe) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0258,Multi-table Join,Determine the closing prices and latest EBITDA for companies in the Technology sector.,"SELECT c.name, sp.close, fs.ebitda FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0259,Aggregation,Calculate the standard deviation of ROI for Financials stocks.,SELECT STDDEV(roi) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0260,Multi-table Join,"List the names, ticker symbols, and current Net Income for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.net_income FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0261,Aggregation,Calculate the average roi across all Financials companies.,SELECT AVG(fm.roi) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0262,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Bank of America.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'BAC' AND date = CURRENT_DATE;
Q0263,Multi-table Join,"Can you find the names, ticker symbols, and current ROI for all Healthcare companies.","SELECT c.name, c.symbol, fm.roi FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0264,Multi-table Join,Extract the closing prices and latest Operating Margin for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.operating_margin FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0265,Simple Retrieval,Identify Coca-Cola's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'KO';"
Q0266,Simple Retrieval,Return the headquarters location for Costco.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'COST';"
Q0267,Multi-table Join,Could you provide the closing prices and latest Profit Margin for companies in the Communication Services sector.,"SELECT c.name, sp.close, fs.profit_margin FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0268,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.05%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.05/100.0) AND fm.date = CURRENT_DATE;
Q0269,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Procter & Gamble.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'PG' AND date = CURRENT_DATE;
Q0270,Multi-table Join,Look up the closing prices and latest Current Ratio for companies in the Communication Services sector.,"SELECT c.name, sp.close, fs.current_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0271,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.5 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.5 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0272,Temporal Filtering,Retrieve the Payout Ratio for Merck TTM?,SELECT payout_ratio FROM financial_statements WHERE symbol = 'MRK' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0273,Temporal Filtering,Find the specific date when Merck hit its highest price over the past 7 days.,SELECT date FROM stock_prices WHERE symbol = 'MRK' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY high DESC LIMIT 1;
Q0274,Aggregation,Find the minimum Dividend Yield reported amongst all tracked equities.,SELECT MIN(dividend_yield) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0275,Multi-table Join,I need the closing prices and latest Quick Ratio for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.quick_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0276,Aggregation,Calculate the average roa across all Technology companies.,SELECT AVG(fm.roa) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0277,Temporal Filtering,Did Amgen report a positive price-to-earnings for the full fiscal year 2023?,SELECT CASE WHEN pe_ratio > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'AMGN' AND period = 'FY' AND year = 2023;
Q0278,Aggregation,Calculate the average total assets across all Financials companies.,SELECT AVG(fm.total_assets) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0279,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.54 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.54 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0280,Simple Retrieval,How many employees work at Verizon?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'VZ';
Q0281,Aggregation,Calculate the standard deviation of ROA for Healthcare stocks.,SELECT STDDEV(roa) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0282,Nested/Complex Logic,Find the percentage contribution of each Technology company's Dividend Yield to the total sector Dividend Yield.,"SELECT c.name, (fs.dividend_yield * 100.0 / SUM(fs.dividend_yield) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0283,Aggregation,What is the total distinct count of industries in the Financials sector?,SELECT COUNT(DISTINCT industry) FROM companies WHERE sector = 'Financials';
Q0284,Simple Retrieval,When did Danaher go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'DHR';
Q0285,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.91%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.91/100.0) AND fm.date = CURRENT_DATE;
Q0286,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's Revenue to the total sector Revenue.,"SELECT c.name, (fs.revenue * 100.0 / SUM(fs.revenue) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0287,Aggregation,Calculate the standard deviation of Dividend Yield for Financials stocks.,SELECT STDDEV(dividend_yield) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0288,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Forward P/E exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.forward_pe > (prev.forward_pe * 1.20);
Q0289,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average EBITDA.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.ebitda > (SELECT AVG(ebitda) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0290,Nested/Complex Logic,Find Energy companies whose Operating Margin is strictly greater than the sector's average Operating Margin.,"WITH SectorAvg AS (SELECT AVG(operating_margin) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.operating_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.operating_margin > sa.avg_val;"
Q0291,Nested/Complex Logic,Find Consumer Defensive companies whose Revenue is strictly greater than the sector's average Revenue.,"WITH SectorAvg AS (SELECT AVG(revenue) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.revenue FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.revenue > sa.avg_val;"
Q0292,Simple Retrieval,Query the ticker symbol associated with Tesla.,SELECT symbol FROM companies WHERE name ILIKE 'Tesla%';
Q0293,Temporal Filtering,Return the maximum daily trading volume for NKE YTD.,"SELECT MAX(volume) FROM stock_prices WHERE symbol = 'NKE' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0294,Nested/Complex Logic,Show Financials stocks exhibiting aggressive growth where this year's Dividend Yield exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Financials' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.dividend_yield > (prev.dividend_yield * 1.20);
Q0295,Aggregation,What is the total sum of beta for the Consumer Defensive sector?,SELECT SUM(fs.beta) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0296,Aggregation,Count the number of stocks where the Revenue exceeds 25.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE revenue > 25;
Q0297,Aggregation,Calculate the average ebitda across all Financials companies.,SELECT AVG(fm.ebitda) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0298,Aggregation,What is the total sum of operating margin for the Consumer Defensive sector?,SELECT SUM(fs.operating_margin) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0299,Nested/Complex Logic,Find Financials companies whose Total Assets is strictly greater than the sector's average Total Assets.,"WITH SectorAvg AS (SELECT AVG(total_assets) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.total_assets FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.total_assets > sa.avg_val;"
Q0300,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.28%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.28/100.0) AND fm.date = CURRENT_DATE;
Q0301,Temporal Filtering,Look up the maximum daily trading volume for JPM over the past 7 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'JPM' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0302,Aggregation,What is the total sum of gross margin for the Communication Services sector?,SELECT SUM(fs.gross_margin) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0303,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.87 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.87 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0304,Simple Retrieval,Identify the closing stock price for PepsiCo?,SELECT close FROM stock_prices WHERE symbol = 'PEP' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'PEP');
Q0305,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 0.82%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (0.82/100.0) AND fm.date = CURRENT_DATE;
Q0306,Multi-table Join,Get the closing prices and latest Payout Ratio for companies in the Energy sector.,"SELECT c.name, sp.close, fs.payout_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0307,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.95 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.95 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0308,Simple Retrieval,Return the official company website for COST.,SELECT website_url FROM company_profiles WHERE symbol = 'COST';
Q0309,Aggregation,What is the total sum of dividend yield for the Communication Services sector?,SELECT SUM(fs.dividend_yield) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0310,Nested/Complex Logic,Find the percentage contribution of each Healthcare company's Debt-to-Equity to the total sector Debt-to-Equity.,"SELECT c.name, (fs.debt_to_equity * 100.0 / SUM(fs.debt_to_equity) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0311,Temporal Filtering,Fetch the maximum daily trading volume for WMT over the past 7 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'WMT' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0312,Simple Retrieval,Identify Amgen's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'AMGN';"
Q0313,Aggregation,Calculate the standard deviation of P/E Ratio for Communication Services stocks.,SELECT STDDEV(pe_ratio) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0314,Multi-table Join,"Show me the names, ticker symbols, and current Forward P/E for all Energy companies.","SELECT c.name, c.symbol, fm.forward_pe FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Energy' AND fm.date = CURRENT_DATE;"
Q0315,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.67%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.67/100.0) AND fm.date = CURRENT_DATE;
Q0316,Temporal Filtering,Find the specific date when UnitedHealth hit its highest price TTM.,SELECT date FROM stock_prices WHERE symbol = 'UNH' AND date >= CURRENT_DATE - INTERVAL '1 year' ORDER BY high DESC LIMIT 1;
Q0317,Temporal Filtering,Find the specific date when Broadcom hit its highest price over the past 7 days.,SELECT date FROM stock_prices WHERE symbol = 'AVGO' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY high DESC LIMIT 1;
Q0318,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Revenue exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.revenue > (prev.revenue * 1.20);
Q0319,Multi-table Join,"Generate a report showing the names, ticker symbols, and current Quick Ratio for all Communication Services companies.","SELECT c.name, c.symbol, fm.quick_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0320,Aggregation,Calculate the standard deviation of Total Assets for Technology stocks.,SELECT STDDEV(total_assets) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0321,Nested/Complex Logic,Identify the single company with the highest Net Income across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.net_income, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.net_income DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, net_income FROM RankedData WHERE rank_id = 1;"
Q0322,Temporal Filtering,Find the specific date when McDonald's hit its highest price in the year 2021.,SELECT date FROM stock_prices WHERE symbol = 'MCD' AND year = 2021 ORDER BY high DESC LIMIT 1;
Q0323,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 4.88 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 4.88 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0324,Simple Retrieval,Who is the Chief Executive Officer of Home Depot?,SELECT ceo_name FROM company_profiles WHERE symbol = 'HD';
Q0325,Simple Retrieval,Look up the ticker symbol associated with Amgen.,SELECT symbol FROM companies WHERE name ILIKE 'Amgen%';
Q0326,Multi-table Join,"Show me Consumer Defensive companies, their ESG scores, and their dividend yields.","SELECT c.name, esg.total_score, fm.dividend_yield FROM companies c JOIN esg_scores esg ON c.symbol = esg.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Defensive';"
Q0327,Simple Retrieval,What is the official company website for AAPL.,SELECT website_url FROM company_profiles WHERE symbol = 'AAPL';
Q0328,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Revenue.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.revenue > (SELECT AVG(revenue) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0329,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Gross Margin.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.gross_margin > (SELECT AVG(gross_margin) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0330,Temporal Filtering,Find the specific date when Home Depot hit its highest price during the last 30 days.,SELECT date FROM stock_prices WHERE symbol = 'HD' AND date >= CURRENT_DATE - INTERVAL '1 month' ORDER BY high DESC LIMIT 1;
Q0331,Temporal Filtering,Show the historical trajectory of Merck's closing prices YTD.,"SELECT date, close FROM stock_prices WHERE symbol = 'MRK' AND date >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY date ASC;"
Q0332,Temporal Filtering,Identify the Current Ratio for Chevron during the last 30 days?,SELECT current_ratio FROM financial_statements WHERE symbol = 'CVX' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0333,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 5 Consumer Cyclical market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 5;"
Q0334,Aggregation,Determine the median acid-test ratio for companies within the Financials sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY quick_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials';
Q0335,Aggregation,What is the total sum of beta for the Energy sector?,SELECT SUM(fs.beta) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0336,Aggregation,Find the minimum Debt-to-Equity reported amongst all tracked equities.,SELECT MIN(debt_to_equity) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0337,Aggregation,Calculate the standard deviation of Dividend Yield for Technology stocks.,SELECT STDDEV(dividend_yield) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0338,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.37 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.37 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0339,Simple Retrieval,Identify Amazon's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'AMZN';"
Q0340,Multi-table Join,"List the top 10 Communication Services stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Communication Services' ORDER BY c.market_cap DESC LIMIT 10;"
Q0341,Aggregation,List the maximum recorded stock price in the Consumer Defensive sector today.,SELECT MAX(sp.high) as max_price FROM stock_prices sp JOIN companies c ON sp.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE;
Q0342,Multi-table Join,Fetch the closing prices and latest Debt-to-Equity for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.debt_to_equity FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0343,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Accenture.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'ACN' AND date = CURRENT_DATE;
Q0344,Simple Retrieval,Who is the Chief Executive Officer of Abbott Labs?,SELECT ceo_name FROM company_profiles WHERE symbol = 'ABT';
Q0345,Multi-table Join,"Show me Financials companies, their ESG scores, and their dividend yields.","SELECT c.name, esg.total_score, fm.dividend_yield FROM companies c JOIN esg_scores esg ON c.symbol = esg.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials';"
Q0346,Multi-table Join,"Calculate the names, ticker symbols, and current Debt-to-Equity for all Healthcare companies.","SELECT c.name, c.symbol, fm.debt_to_equity FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0347,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.55 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.55 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0348,Nested/Complex Logic,Identify the single company with the highest Total Assets across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.total_assets, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.total_assets DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, total_assets FROM RankedData WHERE rank_id = 1;"
Q0349,Aggregation,Determine the median liquidity ratio for companies within the Healthcare sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY current_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0350,Nested/Complex Logic,Find the percentage contribution of each Energy company's Alpha to the total sector Alpha.,"SELECT c.name, (fs.alpha * 100.0 / SUM(fs.alpha) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0351,Aggregation,Calculate the average current ratio across all Healthcare companies.,SELECT AVG(fm.current_ratio) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0352,Temporal Filtering,Identify the Beta for Apple during the fourth quarter of 2022?,SELECT beta FROM financial_statements WHERE symbol = 'AAPL' AND period = 'Q4' AND year = 2022;
Q0353,Simple Retrieval,When did Alphabet go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'GOOG';
Q0354,Nested/Complex Logic,Find Healthcare companies whose Total Liabilities is strictly greater than the sector's average Total Liabilities.,"WITH SectorAvg AS (SELECT AVG(total_liabilities) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.total_liabilities FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.total_liabilities > sa.avg_val;"
Q0355,Simple Retrieval,I'd like to see the official company website for LLY.,SELECT website_url FROM company_profiles WHERE symbol = 'LLY';
Q0356,Simple Retrieval,Identify Home Depot's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'HD';"
Q0357,Aggregation,Calculate the average total liabilities across all Financials companies.,SELECT AVG(fm.total_liabilities) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0358,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.61%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.61/100.0) AND fm.date = CURRENT_DATE;
Q0359,Nested/Complex Logic,Find Healthcare companies whose ROA is strictly greater than the sector's average ROA.,"WITH SectorAvg AS (SELECT AVG(roa) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.roa FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.roa > sa.avg_val;"
Q0360,Multi-table Join,I need the closing prices and latest Total Liabilities for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.total_liabilities FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0361,Temporal Filtering,Show the historical trajectory of McDonald's's closing prices in the year 2021.,"SELECT date, close FROM stock_prices WHERE symbol = 'MCD' AND year = 2021 ORDER BY date ASC;"
Q0362,Nested/Complex Logic,Find Technology companies whose Payout Ratio is strictly greater than the sector's average Payout Ratio.,"WITH SectorAvg AS (SELECT AVG(payout_ratio) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.payout_ratio FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.payout_ratio > sa.avg_val;"
Q0363,Temporal Filtering,Find the specific date when Eli Lilly hit its highest price during the last 30 days.,SELECT date FROM stock_prices WHERE symbol = 'LLY' AND date >= CURRENT_DATE - INTERVAL '1 month' ORDER BY high DESC LIMIT 1;
Q0364,Nested/Complex Logic,Show Financials stocks exhibiting aggressive growth where this year's Operating Margin exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Financials' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.operating_margin > (prev.operating_margin * 1.20);
Q0365,Nested/Complex Logic,Find the percentage contribution of each Technology company's ROE to the total sector ROE.,"SELECT c.name, (fs.roe * 100.0 / SUM(fs.roe) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0366,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 15 Communication Services market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 15;"
Q0367,Temporal Filtering,Did Coca-Cola report a positive asset base in the first quarter of last year?,SELECT CASE WHEN total_assets > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'KO' AND period = 'Q1' AND year = 2023;
Q0368,Nested/Complex Logic,Show Financials stocks exhibiting aggressive growth where this year's Revenue exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Financials' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.revenue > (prev.revenue * 1.20);
Q0369,Aggregation,What is the total sum of ebitda for the Healthcare sector?,SELECT SUM(fs.ebitda) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0370,Simple Retrieval,I need the market capitalization of JPM.,SELECT market_cap FROM companies WHERE symbol = 'JPM';
Q0371,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 50 Communication Services market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 50;"
Q0372,Temporal Filtering,Show me the maximum daily trading volume for NVDA for the full fiscal year 2023.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'NVDA' AND period = 'FY' AND year = 2023;
Q0373,Nested/Complex Logic,Find the percentage contribution of each Energy company's Payout Ratio to the total sector Payout Ratio.,"SELECT c.name, (fs.payout_ratio * 100.0 / SUM(fs.payout_ratio) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0374,Multi-table Join,"Could you provide the names, ticker symbols, and current Gross Margin for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.gross_margin FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0375,Simple Retrieval,Could you provide the market capitalization of KO.,SELECT market_cap FROM companies WHERE symbol = 'KO';
Q0376,Aggregation,Count the number of stocks where the Beta exceeds 20.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE beta > 20;
Q0377,Aggregation,Calculate the average profit margin across all Energy companies.,SELECT AVG(fm.profit_margin) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0378,Nested/Complex Logic,Find Consumer Cyclical companies whose EPS is strictly greater than the sector's average EPS.,"WITH SectorAvg AS (SELECT AVG(eps) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.eps FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.eps > sa.avg_val;"
Q0379,Multi-table Join,"List the top 10 Healthcare stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Healthcare' ORDER BY c.market_cap DESC LIMIT 10;"
Q0380,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Amazon.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'AMZN' AND date = CURRENT_DATE;
Q0381,Temporal Filtering,Identify the Forward P/E for Bank of America for the full fiscal year 2023?,SELECT forward_pe FROM financial_statements WHERE symbol = 'BAC' AND period = 'FY' AND year = 2023;
Q0382,Multi-table Join,Identify the closing prices and latest Forward P/E for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.forward_pe FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0383,Multi-table Join,"Extract the names, ticker symbols, and current Payout Ratio for all Financials companies.","SELECT c.name, c.symbol, fm.payout_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0384,Multi-table Join,"List the top 20 Technology stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Technology' ORDER BY c.market_cap DESC LIMIT 20;"
Q0385,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 10 Technology market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 10;"
Q0386,Multi-table Join,"Show me the names, ticker symbols, and current Total Assets for all Healthcare companies.","SELECT c.name, c.symbol, fm.total_assets FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0387,Nested/Complex Logic,Show Technology stocks exhibiting aggressive growth where this year's ROE exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Technology' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.roe > (prev.roe * 1.20);
Q0388,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Total Assets.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.total_assets > (SELECT AVG(total_assets) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0389,Simple Retrieval,Query the closing stock price for Danaher?,SELECT close FROM stock_prices WHERE symbol = 'DHR' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'DHR');
Q0390,Multi-table Join,Get the closing prices and latest Total Assets for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.total_assets FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0391,Aggregation,Calculate the average net income across all Communication Services companies.,SELECT AVG(fm.net_income) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0392,Simple Retrieval,Return the ticker symbol associated with McDonald's.,SELECT symbol FROM companies WHERE name ILIKE 'McDonald's%';
Q0393,Nested/Complex Logic,Show Consumer Defensive stocks exhibiting aggressive growth where this year's Total Liabilities exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.total_liabilities > (prev.total_liabilities * 1.20);
Q0394,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.16 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.16 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0395,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.53 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.53 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0396,Multi-table Join,"Show me the names, ticker symbols, and current Profit Margin for all Healthcare companies.","SELECT c.name, c.symbol, fm.profit_margin FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0397,Multi-table Join,Extract the closing prices and latest Alpha for companies in the Technology sector.,"SELECT c.name, sp.close, fs.alpha FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0398,Nested/Complex Logic,Show Communication Services stocks exhibiting aggressive growth where this year's Gross Margin exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Communication Services' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.gross_margin > (prev.gross_margin * 1.20);
Q0399,Multi-table Join,"I'd like to see the names, ticker symbols, and current Beta for all Technology companies.","SELECT c.name, c.symbol, fm.beta FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Technology' AND fm.date = CURRENT_DATE;"
Q0400,Simple Retrieval,Identify the market capitalization of AAPL.,SELECT market_cap FROM companies WHERE symbol = 'AAPL';
Q0401,Multi-table Join,"List the top 50 Consumer Defensive stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Defensive' ORDER BY c.market_cap DESC LIMIT 50;"
Q0402,Nested/Complex Logic,Find Consumer Defensive companies whose Current Ratio is strictly greater than the sector's average Current Ratio.,"WITH SectorAvg AS (SELECT AVG(current_ratio) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.current_ratio FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.current_ratio > sa.avg_val;"
Q0403,Simple Retrieval,Who is the Chief Executive Officer of Procter & Gamble?,SELECT ceo_name FROM company_profiles WHERE symbol = 'PG';
Q0404,Multi-table Join,What is the closing prices and latest ROE for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.roe FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0405,Nested/Complex Logic,Find Energy companies whose Beta is strictly greater than the sector's average Beta.,"WITH SectorAvg AS (SELECT AVG(beta) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.beta FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.beta > sa.avg_val;"
Q0406,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.25 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.25 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0407,Temporal Filtering,Find the specific date when Tesla hit its highest price over the past 7 days.,SELECT date FROM stock_prices WHERE symbol = 'TSLA' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY high DESC LIMIT 1;
Q0408,Nested/Complex Logic,Show Technology stocks exhibiting aggressive growth where this year's ROA exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Technology' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.roa > (prev.roa * 1.20);
Q0409,Multi-table Join,Extract the closing prices and latest Dividend Yield for companies in the Communication Services sector.,"SELECT c.name, sp.close, fs.dividend_yield FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0410,Multi-table Join,Please display the closing prices and latest Forward P/E for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.forward_pe FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0411,Multi-table Join,"Could you provide the names, ticker symbols, and current Current Ratio for all Healthcare companies.","SELECT c.name, c.symbol, fm.current_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0412,Multi-table Join,"List the top 3 Financials stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Financials' ORDER BY c.market_cap DESC LIMIT 3;"
Q0413,Temporal Filtering,Did Wells Fargo report a positive gross profit margin over the past 7 days?,SELECT CASE WHEN gross_margin > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'WFC' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0414,Aggregation,Count the number of stocks where the ROA exceeds 100.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE roa > 100;
Q0415,Temporal Filtering,Did Amazon report a positive asset base for the full fiscal year 2023?,SELECT CASE WHEN total_assets > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'AMZN' AND period = 'FY' AND year = 2023;
Q0416,Multi-table Join,"Look up the names, ticker symbols, and current EPS for all Financials companies.","SELECT c.name, c.symbol, fm.eps FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0417,Simple Retrieval,Can you find the market capitalization of META.,SELECT market_cap FROM companies WHERE symbol = 'META';
Q0418,Temporal Filtering,Show the historical trajectory of Texas Instruments's closing prices over the past 7 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'TXN' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date ASC;"
Q0419,Simple Retrieval,Return the closing stock price for Tesla?,SELECT close FROM stock_prices WHERE symbol = 'TSLA' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'TSLA');
Q0420,Nested/Complex Logic,Find the percentage contribution of each Healthcare company's Forward P/E to the total sector Forward P/E.,"SELECT c.name, (fs.forward_pe * 100.0 / SUM(fs.forward_pe) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0421,Temporal Filtering,Show the historical trajectory of Abbott Labs's closing prices over the past 7 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'ABT' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date ASC;"
Q0422,Aggregation,Find the minimum Profit Margin reported amongst all tracked equities.,SELECT MIN(profit_margin) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0423,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Amgen.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'AMGN' AND date = CURRENT_DATE;
Q0424,Multi-table Join,"Show me Communication Services companies, their ESG scores, and their dividend yields.","SELECT c.name, esg.total_score, fm.dividend_yield FROM companies c JOIN esg_scores esg ON c.symbol = esg.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services';"
Q0425,Multi-table Join,Return the closing prices and latest Debt-to-Equity for companies in the Financials sector.,"SELECT c.name, sp.close, fs.debt_to_equity FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0426,Nested/Complex Logic,Find Communication Services companies whose Beta is strictly greater than the sector's average Beta.,"WITH SectorAvg AS (SELECT AVG(beta) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.beta FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.beta > sa.avg_val;"
Q0427,Simple Retrieval,How many employees work at PepsiCo?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'PEP';
Q0428,Temporal Filtering,Retrieve the maximum daily trading volume for DHR in the first quarter of last year.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'DHR' AND period = 'Q1' AND year = 2023;
Q0429,Temporal Filtering,Determine the ROE for JPMorgan Chase over the past 7 days?,SELECT roe FROM financial_statements WHERE symbol = 'JPM' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0430,Aggregation,What is the total distinct count of industries in the Communication Services sector?,SELECT COUNT(DISTINCT industry) FROM companies WHERE sector = 'Communication Services';
Q0431,Multi-table Join,"Get the names, ticker symbols, and current ROA for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.roa FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0432,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.83%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.83/100.0) AND fm.date = CURRENT_DATE;
Q0433,Nested/Complex Logic,Find Consumer Defensive companies whose Operating Margin is strictly greater than the sector's average Operating Margin.,"WITH SectorAvg AS (SELECT AVG(operating_margin) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.operating_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.operating_margin > sa.avg_val;"
Q0434,Multi-table Join,Please display the closing prices and latest Alpha for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.alpha FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0435,Temporal Filtering,Look up the maximum daily trading volume for KO in the year 2021.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'KO' AND year = 2021;
Q0436,Temporal Filtering,List the P/E Ratio for Merck in the year 2021?,SELECT pe_ratio FROM financial_statements WHERE symbol = 'MRK' AND year = 2021;
Q0437,Temporal Filtering,I'd like to see the Quick Ratio for Disney over the past 7 days?,SELECT quick_ratio FROM financial_statements WHERE symbol = 'DIS' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0438,Aggregation,Determine the median return on assets for companies within the Communication Services sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY roa) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0439,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.96%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.96/100.0) AND fm.date = CURRENT_DATE;
Q0440,Multi-table Join,Extract the closing prices and latest EPS for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.eps FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0441,Aggregation,Determine the median gross sales for companies within the Energy sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY revenue) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy';
Q0442,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.97 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.97 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0443,Aggregation,Calculate the standard deviation of Alpha for Financials stocks.,SELECT STDDEV(alpha) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0444,Aggregation,Calculate the average forward p/e across all Energy companies.,SELECT AVG(fm.forward_pe) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0445,Nested/Complex Logic,Find Financials companies whose Total Liabilities is strictly greater than the sector's average Total Liabilities.,"WITH SectorAvg AS (SELECT AVG(total_liabilities) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.total_liabilities FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.total_liabilities > sa.avg_val;"
Q0446,Nested/Complex Logic,Find Consumer Defensive companies whose Free Cash Flow is strictly greater than the sector's average Free Cash Flow.,"WITH SectorAvg AS (SELECT AVG(free_cash_flow) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.free_cash_flow FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.free_cash_flow > sa.avg_val;"
Q0447,Temporal Filtering,Find the specific date when JPMorgan Chase hit its highest price YTD.,"SELECT date FROM stock_prices WHERE symbol = 'JPM' AND date >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY high DESC LIMIT 1;"
Q0448,Aggregation,Calculate the average payout ratio across all Technology companies.,SELECT AVG(fm.payout_ratio) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0449,Temporal Filtering,Show the historical trajectory of Exxon Mobil's closing prices in the first quarter of last year.,"SELECT date, close FROM stock_prices WHERE symbol = 'XOM' AND period = 'Q1' AND year = 2023 ORDER BY date ASC;"
Q0450,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for JPMorgan Chase.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'JPM' AND date = CURRENT_DATE;
Q0451,Simple Retrieval,What is the ticker symbol associated with Broadcom.,SELECT symbol FROM companies WHERE name ILIKE 'Broadcom%';
Q0452,Temporal Filtering,Did Accenture report a positive operating income margin YTD?,"SELECT CASE WHEN operating_margin > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'ACN' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0453,Simple Retrieval,Return the ticker symbol associated with Visa.,SELECT symbol FROM companies WHERE name ILIKE 'Visa%';
Q0454,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.35%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.35/100.0) AND fm.date = CURRENT_DATE;
Q0455,Nested/Complex Logic,Identify the single company with the highest Gross Margin across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.gross_margin, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.gross_margin DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, gross_margin FROM RankedData WHERE rank_id = 1;"
Q0456,Nested/Complex Logic,Find the percentage contribution of each Consumer Cyclical company's Gross Margin to the total sector Gross Margin.,"SELECT c.name, (fs.gross_margin * 100.0 / SUM(fs.gross_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0457,Nested/Complex Logic,Find Consumer Cyclical companies whose Profit Margin is strictly greater than the sector's average Profit Margin.,"WITH SectorAvg AS (SELECT AVG(profit_margin) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.profit_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.profit_margin > sa.avg_val;"
Q0458,Simple Retrieval,Calculate the closing stock price for Johnson & Johnson?,SELECT close FROM stock_prices WHERE symbol = 'JNJ' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'JNJ');
Q0459,Multi-table Join,Retrieve the closing prices and latest Total Assets for companies in the Technology sector.,"SELECT c.name, sp.close, fs.total_assets FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0460,Temporal Filtering,Determine the Alpha for Bank of America TTM?,SELECT alpha FROM financial_statements WHERE symbol = 'BAC' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0461,Multi-table Join,"List the top 20 Healthcare stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Healthcare' ORDER BY c.market_cap DESC LIMIT 20;"
Q0462,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 4.06 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 4.06 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0463,Temporal Filtering,Show the historical trajectory of Exxon Mobil's closing prices over the past 7 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'XOM' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date ASC;"
Q0464,Aggregation,Count the number of stocks where the Debt-to-Equity exceeds 25.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE debt_to_equity > 25;
Q0465,Temporal Filtering,Show the historical trajectory of JPMorgan Chase's closing prices YTD.,"SELECT date, close FROM stock_prices WHERE symbol = 'JPM' AND date >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY date ASC;"
Q0466,Multi-table Join,Calculate the closing prices and latest Net Income for companies in the Technology sector.,"SELECT c.name, sp.close, fs.net_income FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0467,Temporal Filtering,Did Coca-Cola report a positive earnings per share for the full fiscal year 2023?,SELECT CASE WHEN eps > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'KO' AND period = 'FY' AND year = 2023;
Q0468,Nested/Complex Logic,Show Consumer Cyclical stocks exhibiting aggressive growth where this year's Free Cash Flow exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.free_cash_flow > (prev.free_cash_flow * 1.20);
Q0469,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.8 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.8 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0470,Nested/Complex Logic,Find the percentage contribution of each Energy company's ROA to the total sector ROA.,"SELECT c.name, (fs.roa * 100.0 / SUM(fs.roa) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0471,Temporal Filtering,Did Costco report a positive total debt over the past 7 days?,SELECT CASE WHEN total_liabilities > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'COST' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0472,Simple Retrieval,I'd like to see the official company website for PG.,SELECT website_url FROM company_profiles WHERE symbol = 'PG';
Q0473,Multi-table Join,Could you provide the closing prices and latest Debt-to-Equity for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.debt_to_equity FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0474,Simple Retrieval,When did Costco go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'COST';
Q0475,Temporal Filtering,Find the specific date when Home Depot hit its highest price for the full fiscal year 2023.,SELECT date FROM stock_prices WHERE symbol = 'HD' AND period = 'FY' AND year = 2023 ORDER BY high DESC LIMIT 1;
Q0476,Nested/Complex Logic,Identify the single company with the highest Revenue across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.revenue, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.revenue DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, revenue FROM RankedData WHERE rank_id = 1;"
Q0477,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Operating Margin.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.operating_margin > (SELECT AVG(operating_margin) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0478,Aggregation,Calculate the average beta across all Communication Services companies.,SELECT AVG(fm.beta) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0479,Aggregation,Calculate the average roa across all Energy companies.,SELECT AVG(fm.roa) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0480,Simple Retrieval,Extract the ticker symbol associated with Apple.,SELECT symbol FROM companies WHERE name ILIKE 'Apple%';
Q0481,Simple Retrieval,What is the official company website for CSCO.,SELECT website_url FROM company_profiles WHERE symbol = 'CSCO';
Q0482,Nested/Complex Logic,Identify the single company with the highest ROE across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.roe, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.roe DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, roe FROM RankedData WHERE rank_id = 1;"
Q0483,Temporal Filtering,Find the specific date when AbbVie hit its highest price TTM.,SELECT date FROM stock_prices WHERE symbol = 'ABBV' AND date >= CURRENT_DATE - INTERVAL '1 year' ORDER BY high DESC LIMIT 1;
Q0484,Multi-table Join,Look up the closing prices and latest Quick Ratio for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.quick_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0485,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 3 Financials market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 3;"
Q0486,Simple Retrieval,How many employees work at Mastercard?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'MA';
Q0487,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.87%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.87/100.0) AND fm.date = CURRENT_DATE;
Q0488,Simple Retrieval,Look up the ticker symbol associated with Microsoft.,SELECT symbol FROM companies WHERE name ILIKE 'Microsoft%';
Q0489,Multi-table Join,"List the names, ticker symbols, and current ROE for all Healthcare companies.","SELECT c.name, c.symbol, fm.roe FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0490,Simple Retrieval,I need the official company website for MSFT.,SELECT website_url FROM company_profiles WHERE symbol = 'MSFT';
Q0491,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Total Liabilities.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.total_liabilities > (SELECT AVG(total_liabilities) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0492,Nested/Complex Logic,Identify the single company with the highest Payout Ratio across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.payout_ratio, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.payout_ratio DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, payout_ratio FROM RankedData WHERE rank_id = 1;"
Q0493,Multi-table Join,List the closing prices and latest ROI for companies in the Financials sector.,"SELECT c.name, sp.close, fs.roi FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0494,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 3 Technology market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 3;"
Q0495,Aggregation,What is the total sum of ebitda for the Technology sector?,SELECT SUM(fs.ebitda) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0496,Nested/Complex Logic,Show Energy stocks exhibiting aggressive growth where this year's Forward P/E exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Energy' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.forward_pe > (prev.forward_pe * 1.20);
Q0497,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for PepsiCo.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'PEP' AND date = CURRENT_DATE;
Q0498,Temporal Filtering,Fetch the maximum daily trading volume for CSCO TTM.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'CSCO' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0499,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.99%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.99/100.0) AND fm.date = CURRENT_DATE;
Q0500,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.14 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.14 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0501,Multi-table Join,"List the top 20 Consumer Defensive stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Defensive' ORDER BY c.market_cap DESC LIMIT 20;"
Q0502,Simple Retrieval,Identify Abbott Labs's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'ABT';"
Q0503,Aggregation,Determine the median liquidity ratio for companies within the Energy sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY current_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy';
Q0504,Simple Retrieval,How many employees work at Visa?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'V';
Q0505,Aggregation,Find the minimum P/E Ratio reported amongst all tracked equities.,SELECT MIN(pe_ratio) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0506,Simple Retrieval,Who is the Chief Executive Officer of Cisco?,SELECT ceo_name FROM company_profiles WHERE symbol = 'CSCO';
Q0507,Simple Retrieval,List all companies classified under the Financials sector.,"SELECT name, symbol FROM companies WHERE sector = 'Financials' ORDER BY name ASC;"
Q0508,Simple Retrieval,I'd like to see the closing stock price for Texas Instruments?,SELECT close FROM stock_prices WHERE symbol = 'TXN' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'TXN');
Q0509,Multi-table Join,"List the top 10 Energy stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Energy' ORDER BY c.market_cap DESC LIMIT 10;"
Q0510,Temporal Filtering,Find the specific date when Bank of America hit its highest price during the fourth quarter of 2022.,SELECT date FROM stock_prices WHERE symbol = 'BAC' AND period = 'Q4' AND year = 2022 ORDER BY high DESC LIMIT 1;
Q0511,Aggregation,Determine the median acid-test ratio for companies within the Healthcare sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY quick_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0512,Multi-table Join,"List the top 50 Healthcare stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Healthcare' ORDER BY c.market_cap DESC LIMIT 50;"
Q0513,Temporal Filtering,Fetch the Dividend Yield for UnitedHealth during the fourth quarter of 2022?,SELECT dividend_yield FROM financial_statements WHERE symbol = 'UNH' AND period = 'Q4' AND year = 2022;
Q0514,Aggregation,Find the minimum Total Liabilities reported amongst all tracked equities.,SELECT MIN(total_liabilities) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0515,Aggregation,Look up the maximum recorded stock price in the Financials sector today.,SELECT MAX(sp.high) as max_price FROM stock_prices sp JOIN companies c ON sp.symbol = c.symbol WHERE c.sector = 'Financials' AND sp.date = CURRENT_DATE;
Q0516,Multi-table Join,"Show me the names, ticker symbols, and current Quick Ratio for all Financials companies.","SELECT c.name, c.symbol, fm.quick_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0517,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's Payout Ratio to the total sector Payout Ratio.,"SELECT c.name, (fs.payout_ratio * 100.0 / SUM(fs.payout_ratio) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0518,Aggregation,Determine the median operating income margin for companies within the Communication Services sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY operating_margin) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0519,Multi-table Join,Calculate the closing prices and latest ROI for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.roi FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0520,Simple Retrieval,Determine the market capitalization of V.,SELECT market_cap FROM companies WHERE symbol = 'V';
Q0521,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 5 Communication Services market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 5;"
Q0522,Multi-table Join,"List the top 5 Communication Services stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Communication Services' ORDER BY c.market_cap DESC LIMIT 5;"
Q0523,Multi-table Join,"Look up the names, ticker symbols, and current Current Ratio for all Energy companies.","SELECT c.name, c.symbol, fm.current_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Energy' AND fm.date = CURRENT_DATE;"
Q0524,Nested/Complex Logic,Show Consumer Defensive stocks exhibiting aggressive growth where this year's Operating Margin exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.operating_margin > (prev.operating_margin * 1.20);
Q0525,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.65 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.65 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0526,Simple Retrieval,Get the market capitalization of DIS.,SELECT market_cap FROM companies WHERE symbol = 'DIS';
Q0527,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.19 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.19 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0528,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Apple.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'AAPL' AND date = CURRENT_DATE;
Q0529,Multi-table Join,"List the top 50 Communication Services stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Communication Services' ORDER BY c.market_cap DESC LIMIT 50;"
Q0530,Multi-table Join,"Get the names, ticker symbols, and current Total Liabilities for all Financials companies.","SELECT c.name, c.symbol, fm.total_liabilities FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0531,Temporal Filtering,Did Nike report a positive FCF over the past 7 days?,SELECT CASE WHEN free_cash_flow > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'NKE' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0532,Temporal Filtering,Calculate the maximum daily trading volume for PG during the last 30 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'PG' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0533,Multi-table Join,"List the top 3 Communication Services stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Communication Services' ORDER BY c.market_cap DESC LIMIT 3;"
Q0534,Temporal Filtering,Did Comcast report a positive return on investment during the last 30 days?,SELECT CASE WHEN roi > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'CMCSA' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0535,Simple Retrieval,Extract the market capitalization of BRK.B.,SELECT market_cap FROM companies WHERE symbol = 'BRK.B';
Q0536,Multi-table Join,Could you provide the closing prices and latest Net Income for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.net_income FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0537,Simple Retrieval,I'd like to see the headquarters location for Walmart.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'WMT';"
Q0538,Temporal Filtering,Show the historical trajectory of Amazon's closing prices TTM.,"SELECT date, close FROM stock_prices WHERE symbol = 'AMZN' AND date >= CURRENT_DATE - INTERVAL '1 year' ORDER BY date ASC;"
Q0539,Temporal Filtering,Show the historical trajectory of Amazon's closing prices during the fourth quarter of 2022.,"SELECT date, close FROM stock_prices WHERE symbol = 'AMZN' AND period = 'Q4' AND year = 2022 ORDER BY date ASC;"
Q0540,Simple Retrieval,Who is the Chief Executive Officer of Berkshire Hathaway?,SELECT ceo_name FROM company_profiles WHERE symbol = 'BRK.B';
Q0541,Aggregation,What is the total sum of forward p/e for the Financials sector?,SELECT SUM(fs.forward_pe) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0542,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.7%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.7/100.0) AND fm.date = CURRENT_DATE;
Q0543,Nested/Complex Logic,Show Consumer Cyclical stocks exhibiting aggressive growth where this year's P/E Ratio exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.pe_ratio > (prev.pe_ratio * 1.20);
Q0544,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's ROI to the total sector ROI.,"SELECT c.name, (fs.roi * 100.0 / SUM(fs.roi) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0545,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.98 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.98 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0546,Nested/Complex Logic,Identify the single company with the highest ROI across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.roi, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.roi DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, roi FROM RankedData WHERE rank_id = 1;"
Q0547,Multi-table Join,Can you find the closing prices and latest Payout Ratio for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.payout_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0548,Aggregation,Count the number of stocks where the Alpha exceeds 5.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE alpha > 5;
Q0549,Multi-table Join,"Can you find the names, ticker symbols, and current Beta for all Financials companies.","SELECT c.name, c.symbol, fm.beta FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0550,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 15 Financials market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 15;"
Q0551,Nested/Complex Logic,Find the percentage contribution of each Healthcare company's EBITDA to the total sector EBITDA.,"SELECT c.name, (fs.ebitda * 100.0 / SUM(fs.ebitda) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0552,Nested/Complex Logic,Find the percentage contribution of each Consumer Cyclical company's Quick Ratio to the total sector Quick Ratio.,"SELECT c.name, (fs.quick_ratio * 100.0 / SUM(fs.quick_ratio) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0553,Temporal Filtering,List the Total Assets for Meta Platforms in the first quarter of last year?,SELECT total_assets FROM financial_statements WHERE symbol = 'META' AND period = 'Q1' AND year = 2023;
Q0554,Aggregation,What is the total distinct count of industries in the Consumer Cyclical sector?,SELECT COUNT(DISTINCT industry) FROM companies WHERE sector = 'Consumer Cyclical';
Q0555,Nested/Complex Logic,Show Communication Services stocks exhibiting aggressive growth where this year's Quick Ratio exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Communication Services' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.quick_ratio > (prev.quick_ratio * 1.20);
Q0556,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Net Income.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.net_income > (SELECT AVG(net_income) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0557,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 4.73 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 4.73 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0558,Simple Retrieval,Retrieve the market capitalization of UNH.,SELECT market_cap FROM companies WHERE symbol = 'UNH';
Q0559,Nested/Complex Logic,Show Technology stocks exhibiting aggressive growth where this year's EPS exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Technology' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.eps > (prev.eps * 1.20);
Q0560,Aggregation,Calculate the standard deviation of Current Ratio for Consumer Cyclical stocks.,SELECT STDDEV(current_ratio) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0561,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average ROA.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.roa > (SELECT AVG(roa) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0562,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.23 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.23 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0563,Temporal Filtering,Identify the Total Assets for Cisco for the full fiscal year 2023?,SELECT total_assets FROM financial_statements WHERE symbol = 'CSCO' AND period = 'FY' AND year = 2023;
Q0564,Simple Retrieval,Calculate the closing stock price for Mastercard?,SELECT close FROM stock_prices WHERE symbol = 'MA' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'MA');
Q0565,Aggregation,Calculate the standard deviation of EBITDA for Communication Services stocks.,SELECT STDDEV(ebitda) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0566,Simple Retrieval,When did Microsoft go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'MSFT';
Q0567,Multi-table Join,"I'd like to see the names, ticker symbols, and current Dividend Yield for all Consumer Defensive companies.","SELECT c.name, c.symbol, fm.dividend_yield FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Defensive' AND fm.date = CURRENT_DATE;"
Q0568,Multi-table Join,I'd like to see the closing prices and latest Revenue for companies in the Energy sector.,"SELECT c.name, sp.close, fs.revenue FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0569,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.68 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.68 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0570,Temporal Filtering,Show me the maximum daily trading volume for WFC in the first quarter of last year.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'WFC' AND period = 'Q1' AND year = 2023;
Q0571,Nested/Complex Logic,Identify the single company with the highest Debt-to-Equity across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.debt_to_equity, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.debt_to_equity DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, debt_to_equity FROM RankedData WHERE rank_id = 1;"
Q0572,Simple Retrieval,When did Nvidia go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'NVDA';
Q0573,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.33 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.33 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0574,Multi-table Join,"Get the names, ticker symbols, and current Total Assets for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.total_assets FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0575,Aggregation,Determine the median operating profit for companies within the Financials sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY ebitda) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials';
Q0576,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.78 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.78 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0577,Multi-table Join,Extract the closing prices and latest Beta for companies in the Technology sector.,"SELECT c.name, sp.close, fs.beta FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0578,Temporal Filtering,Find the specific date when Berkshire Hathaway hit its highest price YTD.,"SELECT date FROM stock_prices WHERE symbol = 'BRK.B' AND date >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY high DESC LIMIT 1;"
Q0579,Aggregation,Calculate the standard deviation of Profit Margin for Healthcare stocks.,SELECT STDDEV(profit_margin) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0580,Multi-table Join,"Fetch the names, ticker symbols, and current Operating Margin for all Communication Services companies.","SELECT c.name, c.symbol, fm.operating_margin FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0581,Temporal Filtering,Calculate the maximum daily trading volume for WFC YTD.,"SELECT MAX(volume) FROM stock_prices WHERE symbol = 'WFC' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0582,Nested/Complex Logic,Find Consumer Defensive companies whose EPS is strictly greater than the sector's average EPS.,"WITH SectorAvg AS (SELECT AVG(eps) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.eps FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.eps > sa.avg_val;"
Q0583,Aggregation,Calculate the average payout ratio across all Financials companies.,SELECT AVG(fm.payout_ratio) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0584,Simple Retrieval,Identify Eli Lilly's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'LLY';"
Q0585,Aggregation,Calculate the average roi across all Communication Services companies.,SELECT AVG(fm.roi) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0586,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.62 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.62 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0587,Aggregation,Determine the median return on equity for companies within the Consumer Defensive sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY roe) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive';
Q0588,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's P/E Ratio to the total sector P/E Ratio.,"SELECT c.name, (fs.pe_ratio * 100.0 / SUM(fs.pe_ratio) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0589,Multi-table Join,"Please display the names, ticker symbols, and current Total Liabilities for all Communication Services companies.","SELECT c.name, c.symbol, fm.total_liabilities FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0590,Nested/Complex Logic,Find the percentage contribution of each Consumer Cyclical company's Forward P/E to the total sector Forward P/E.,"SELECT c.name, (fs.forward_pe * 100.0 / SUM(fs.forward_pe) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0591,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.11 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.11 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0592,Simple Retrieval,Get the ticker symbol associated with Mastercard.,SELECT symbol FROM companies WHERE name ILIKE 'Mastercard%';
Q0593,Temporal Filtering,Did JPMorgan Chase report a positive return on equity over the past 7 days?,SELECT CASE WHEN roe > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'JPM' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0594,Temporal Filtering,Find the specific date when Danaher hit its highest price over the past 7 days.,SELECT date FROM stock_prices WHERE symbol = 'DHR' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY high DESC LIMIT 1;
Q0595,Temporal Filtering,Did Home Depot report a positive bottom line YTD?,"SELECT CASE WHEN net_income > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'HD' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0596,Temporal Filtering,Show the historical trajectory of Philip Morris's closing prices during the last 30 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'PM' AND date >= CURRENT_DATE - INTERVAL '1 month' ORDER BY date ASC;"
Q0597,Simple Retrieval,Extract the closing stock price for Broadcom?,SELECT close FROM stock_prices WHERE symbol = 'AVGO' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'AVGO');
Q0598,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for McDonald's.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'MCD' AND date = CURRENT_DATE;
Q0599,Simple Retrieval,List the headquarters location for Mastercard.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'MA';"
Q0600,Multi-table Join,Look up the closing prices and latest Gross Margin for companies in the Energy sector.,"SELECT c.name, sp.close, fs.gross_margin FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0601,Multi-table Join,"What is the names, ticker symbols, and current Payout Ratio for all Communication Services companies.","SELECT c.name, c.symbol, fm.payout_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0602,Temporal Filtering,Show the historical trajectory of Disney's closing prices during the last 30 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'DIS' AND date >= CURRENT_DATE - INTERVAL '1 month' ORDER BY date ASC;"
Q0603,Simple Retrieval,Extract the headquarters location for Coca-Cola.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'KO';"
Q0604,Simple Retrieval,Could you provide the official company website for ABT.,SELECT website_url FROM company_profiles WHERE symbol = 'ABT';
Q0605,Multi-table Join,"Can you find the names, ticker symbols, and current EPS for all Technology companies.","SELECT c.name, c.symbol, fm.eps FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Technology' AND fm.date = CURRENT_DATE;"
Q0606,Multi-table Join,Identify the closing prices and latest EPS for companies in the Consumer Defensive sector.,"SELECT c.name, sp.close, fs.eps FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0607,Simple Retrieval,Fetch the official company website for AMGN.,SELECT website_url FROM company_profiles WHERE symbol = 'AMGN';
Q0608,Simple Retrieval,What is the official company website for ACN.,SELECT website_url FROM company_profiles WHERE symbol = 'ACN';
Q0609,Multi-table Join,Identify the closing prices and latest ROA for companies in the Technology sector.,"SELECT c.name, sp.close, fs.roa FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0610,Simple Retrieval,Could you provide the market capitalization of CVX.,SELECT market_cap FROM companies WHERE symbol = 'CVX';
Q0611,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 10 Consumer Defensive market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 10;"
Q0612,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 4.76 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 4.76 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0613,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Free Cash Flow.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.free_cash_flow > (SELECT AVG(free_cash_flow) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0614,Temporal Filtering,Calculate the Beta for Abbott Labs TTM?,SELECT beta FROM financial_statements WHERE symbol = 'ABT' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0615,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.84 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.84 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0616,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 5 Healthcare market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 5;"
Q0617,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.86%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.86/100.0) AND fm.date = CURRENT_DATE;
Q0618,Multi-table Join,"I need the names, ticker symbols, and current Revenue for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.revenue FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0619,Aggregation,Count the number of stocks where the Gross Margin exceeds 15.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE gross_margin > 15;
Q0620,Nested/Complex Logic,Find the percentage contribution of each Energy company's EPS to the total sector EPS.,"SELECT c.name, (fs.eps * 100.0 / SUM(fs.eps) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0621,Aggregation,Calculate the standard deviation of Debt-to-Equity for Communication Services stocks.,SELECT STDDEV(debt_to_equity) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0622,Temporal Filtering,Did Wells Fargo report a positive acid-test ratio during the fourth quarter of 2022?,SELECT CASE WHEN quick_ratio > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'WFC' AND period = 'Q4' AND year = 2022;
Q0623,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.8%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.8/100.0) AND fm.date = CURRENT_DATE;
Q0624,Temporal Filtering,Show the historical trajectory of Merck's closing prices during the last 30 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'MRK' AND date >= CURRENT_DATE - INTERVAL '1 month' ORDER BY date ASC;"
Q0625,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.54%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.54/100.0) AND fm.date = CURRENT_DATE;
Q0626,Aggregation,What is the total distinct count of industries in the Consumer Defensive sector?,SELECT COUNT(DISTINCT industry) FROM companies WHERE sector = 'Consumer Defensive';
Q0627,Temporal Filtering,Find the specific date when Costco hit its highest price in the year 2021.,SELECT date FROM stock_prices WHERE symbol = 'COST' AND year = 2021 ORDER BY high DESC LIMIT 1;
Q0628,Aggregation,Calculate the standard deviation of Net Income for Technology stocks.,SELECT STDDEV(net_income) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0629,Simple Retrieval,Query the ticker symbol associated with Philip Morris.,SELECT symbol FROM companies WHERE name ILIKE 'Philip Morris%';
Q0630,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Home Depot.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'HD' AND date = CURRENT_DATE;
Q0631,Temporal Filtering,Extract the P/E Ratio for McDonald's during the fourth quarter of 2022?,SELECT pe_ratio FROM financial_statements WHERE symbol = 'MCD' AND period = 'Q4' AND year = 2022;
Q0632,Aggregation,Count the number of stocks where the Total Assets exceeds 100.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE total_assets > 100;
Q0633,Aggregation,Find the minimum Gross Margin reported amongst all tracked equities.,SELECT MIN(gross_margin) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0634,Aggregation,Calculate the standard deviation of ROE for Consumer Defensive stocks.,SELECT STDDEV(roe) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Defensive';
Q0635,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 50 Consumer Defensive market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 50;"
Q0636,Multi-table Join,"What is the names, ticker symbols, and current ROA for all Technology companies.","SELECT c.name, c.symbol, fm.roa FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Technology' AND fm.date = CURRENT_DATE;"
Q0637,Nested/Complex Logic,Find Energy companies whose P/E Ratio is strictly greater than the sector's average P/E Ratio.,"WITH SectorAvg AS (SELECT AVG(pe_ratio) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.pe_ratio FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.pe_ratio > sa.avg_val;"
Q0638,Nested/Complex Logic,Find the percentage contribution of each Technology company's Revenue to the total sector Revenue.,"SELECT c.name, (fs.revenue * 100.0 / SUM(fs.revenue) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0639,Aggregation,Find the minimum Quick Ratio reported amongst all tracked equities.,SELECT MIN(quick_ratio) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0640,Multi-table Join,"List the top 50 Consumer Cyclical stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Cyclical' ORDER BY c.market_cap DESC LIMIT 50;"
Q0641,Temporal Filtering,Look up the ROI for Danaher in the first quarter of last year?,SELECT roi FROM financial_statements WHERE symbol = 'DHR' AND period = 'Q1' AND year = 2023;
Q0642,Multi-table Join,"List the top 10 Consumer Defensive stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Defensive' ORDER BY c.market_cap DESC LIMIT 10;"
Q0643,Simple Retrieval,Please display the market capitalization of HD.,SELECT market_cap FROM companies WHERE symbol = 'HD';
Q0644,Multi-table Join,Look up the closing prices and latest Total Assets for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.total_assets FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0645,Temporal Filtering,Show the historical trajectory of Nike's closing prices in the first quarter of last year.,"SELECT date, close FROM stock_prices WHERE symbol = 'NKE' AND period = 'Q1' AND year = 2023 ORDER BY date ASC;"
Q0646,Simple Retrieval,What is the closing stock price for McDonald's?,SELECT close FROM stock_prices WHERE symbol = 'MCD' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'MCD');
Q0647,Multi-table Join,Could you provide the closing prices and latest Revenue for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.revenue FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0648,Multi-table Join,"Show me Energy companies, their ESG scores, and their dividend yields.","SELECT c.name, esg.total_score, fm.dividend_yield FROM companies c JOIN esg_scores esg ON c.symbol = esg.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Energy';"
Q0649,Aggregation,Calculate the standard deviation of EBITDA for Healthcare stocks.,SELECT STDDEV(ebitda) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0650,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's Beta to the total sector Beta.,"SELECT c.name, (fs.beta * 100.0 / SUM(fs.beta) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0651,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.07%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.07/100.0) AND fm.date = CURRENT_DATE;
Q0652,Aggregation,Determine the median asset base for companies within the Consumer Defensive sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_assets) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive';
Q0653,Temporal Filtering,Did JPMorgan Chase report a positive net margin in the first quarter of last year?,SELECT CASE WHEN profit_margin > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'JPM' AND period = 'Q1' AND year = 2023;
Q0654,Nested/Complex Logic,Find Energy companies whose Total Liabilities is strictly greater than the sector's average Total Liabilities.,"WITH SectorAvg AS (SELECT AVG(total_liabilities) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.total_liabilities FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.total_liabilities > sa.avg_val;"
Q0655,Simple Retrieval,What is the ticker symbol associated with Danaher.,SELECT symbol FROM companies WHERE name ILIKE 'Danaher%';
Q0656,Aggregation,Determine the median excess return for companies within the Energy sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY alpha) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy';
Q0657,Nested/Complex Logic,Find Energy companies whose ROE is strictly greater than the sector's average ROE.,"WITH SectorAvg AS (SELECT AVG(roe) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.roe FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.roe > sa.avg_val;"
Q0658,Temporal Filtering,Did Johnson & Johnson report a positive operating profit during the last 30 days?,SELECT CASE WHEN ebitda > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'JNJ' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0659,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 4.93 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 4.93 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0660,Aggregation,What is the total sum of operating margin for the Healthcare sector?,SELECT SUM(fs.operating_margin) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0661,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Wells Fargo.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'WFC' AND date = CURRENT_DATE;
Q0662,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.49%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.49/100.0) AND fm.date = CURRENT_DATE;
Q0663,Temporal Filtering,What is the maximum daily trading volume for BAC during the last 30 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'BAC' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0664,Temporal Filtering,Did Disney report a positive estimated P/E in the year 2021?,SELECT CASE WHEN forward_pe > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'DIS' AND year = 2021;
Q0665,Temporal Filtering,Show the historical trajectory of Johnson & Johnson's closing prices in the year 2021.,"SELECT date, close FROM stock_prices WHERE symbol = 'JNJ' AND year = 2021 ORDER BY date ASC;"
Q0666,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.83%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.83/100.0) AND fm.date = CURRENT_DATE;
Q0667,Nested/Complex Logic,Show Consumer Defensive stocks exhibiting aggressive growth where this year's Forward P/E exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.forward_pe > (prev.forward_pe * 1.20);
Q0668,Nested/Complex Logic,Show Financials stocks exhibiting aggressive growth where this year's Quick Ratio exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Financials' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.quick_ratio > (prev.quick_ratio * 1.20);
Q0669,Nested/Complex Logic,Show Communication Services stocks exhibiting aggressive growth where this year's ROA exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Communication Services' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.roa > (prev.roa * 1.20);
Q0670,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.24 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.24 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0671,Aggregation,Find the minimum ROA reported amongst all tracked equities.,SELECT MIN(roa) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0672,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 0.65%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (0.65/100.0) AND fm.date = CURRENT_DATE;
Q0673,Aggregation,Find the minimum Total Assets reported amongst all tracked equities.,SELECT MIN(total_assets) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0674,Aggregation,Calculate the standard deviation of Revenue for Financials stocks.,SELECT STDDEV(revenue) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Financials';
Q0675,Multi-table Join,"Show me Consumer Cyclical companies, their ESG scores, and their dividend yields.","SELECT c.name, esg.total_score, fm.dividend_yield FROM companies c JOIN esg_scores esg ON c.symbol = esg.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical';"
Q0676,Multi-table Join,"List the names, ticker symbols, and current Operating Margin for all Energy companies.","SELECT c.name, c.symbol, fm.operating_margin FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Energy' AND fm.date = CURRENT_DATE;"
Q0677,Simple Retrieval,How many employees work at Microsoft?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'MSFT';
Q0678,Simple Retrieval,Query the ticker symbol associated with Nike.,SELECT symbol FROM companies WHERE name ILIKE 'Nike%';
Q0679,Multi-table Join,"What is the names, ticker symbols, and current ROI for all Technology companies.","SELECT c.name, c.symbol, fm.roi FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Technology' AND fm.date = CURRENT_DATE;"
Q0680,Aggregation,Determine the median asset base for companies within the Consumer Cyclical sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_assets) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0681,Temporal Filtering,Can you find the maximum daily trading volume for VZ for the full fiscal year 2023.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'VZ' AND period = 'FY' AND year = 2023;
Q0682,Simple Retrieval,Query the market capitalization of MCD.,SELECT market_cap FROM companies WHERE symbol = 'MCD';
Q0683,Aggregation,Get the maximum recorded stock price in the Communication Services sector today.,SELECT MAX(sp.high) as max_price FROM stock_prices sp JOIN companies c ON sp.symbol = c.symbol WHERE c.sector = 'Communication Services' AND sp.date = CURRENT_DATE;
Q0684,Temporal Filtering,Could you provide the Alpha for Wells Fargo during the fourth quarter of 2022?,SELECT alpha FROM financial_statements WHERE symbol = 'WFC' AND period = 'Q4' AND year = 2022;
Q0685,Aggregation,Count the number of stocks where the P/E Ratio exceeds 50.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE pe_ratio > 50;
Q0686,Multi-table Join,"List the top 5 Consumer Cyclical stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Cyclical' ORDER BY c.market_cap DESC LIMIT 5;"
Q0687,Multi-table Join,Could you provide the closing prices and latest Total Assets for companies in the Energy sector.,"SELECT c.name, sp.close, fs.total_assets FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0688,Temporal Filtering,Can you find the maximum daily trading volume for ABBV during the last 30 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'ABBV' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0689,Multi-table Join,"What is the names, ticker symbols, and current Current Ratio for all Consumer Defensive companies.","SELECT c.name, c.symbol, fm.current_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Defensive' AND fm.date = CURRENT_DATE;"
Q0690,Temporal Filtering,List the maximum daily trading volume for PEP YTD.,"SELECT MAX(volume) FROM stock_prices WHERE symbol = 'PEP' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0691,Nested/Complex Logic,Find the percentage contribution of each Healthcare company's Alpha to the total sector Alpha.,"SELECT c.name, (fs.alpha * 100.0 / SUM(fs.alpha) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0692,Nested/Complex Logic,Find the percentage contribution of each Communication Services company's Forward P/E to the total sector Forward P/E.,"SELECT c.name, (fs.forward_pe * 100.0 / SUM(fs.forward_pe) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0693,Nested/Complex Logic,Find Consumer Cyclical companies whose Operating Margin is strictly greater than the sector's average Operating Margin.,"WITH SectorAvg AS (SELECT AVG(operating_margin) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.operating_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.operating_margin > sa.avg_val;"
Q0694,Temporal Filtering,I'd like to see the ROI for Accenture for the full fiscal year 2023?,SELECT roi FROM financial_statements WHERE symbol = 'ACN' AND period = 'FY' AND year = 2023;
Q0695,Temporal Filtering,Query the Beta for Visa TTM?,SELECT beta FROM financial_statements WHERE symbol = 'V' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0696,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 10 Financials market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 10;"
Q0697,Aggregation,What is the total distinct count of industries in the Technology sector?,SELECT COUNT(DISTINCT industry) FROM companies WHERE sector = 'Technology';
Q0698,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average EPS.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.eps > (SELECT AVG(eps) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0699,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 20 Technology market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 20;"
Q0700,Aggregation,Determine the median return on equity for companies within the Consumer Cyclical sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY roe) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0701,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.87%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.87/100.0) AND fm.date = CURRENT_DATE;
Q0702,Aggregation,Determine the median asset base for companies within the Technology sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_assets) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology';
Q0703,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 10 Energy market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 10;"
Q0704,Aggregation,Calculate the average p/e ratio across all Energy companies.,SELECT AVG(fm.pe_ratio) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0705,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Current Ratio exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.current_ratio > (prev.current_ratio * 1.20);
Q0706,Simple Retrieval,When did Apple go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'AAPL';
Q0707,Temporal Filtering,Did Tesla report a positive FCF during the last 30 days?,SELECT CASE WHEN free_cash_flow > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'TSLA' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0708,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Profit Margin.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.profit_margin > (SELECT AVG(profit_margin) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0709,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Philip Morris.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'PM' AND date = CURRENT_DATE;
Q0710,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.42 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.42 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0711,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Abbott Labs.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'ABT' AND date = CURRENT_DATE;
Q0712,Aggregation,Determine the median dividend payout for companies within the Consumer Cyclical sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY payout_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0713,Aggregation,Count the number of stocks where the Revenue exceeds 15.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE revenue > 15;
Q0714,Aggregation,Count the number of stocks where the Total Liabilities exceeds 50.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE total_liabilities > 50;
Q0715,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average ROE.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.roe > (SELECT AVG(roe) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0716,Aggregation,Determine the median earnings per share for companies within the Energy sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY eps) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy';
Q0717,Multi-table Join,"Look up the names, ticker symbols, and current Total Liabilities for all Technology companies.","SELECT c.name, c.symbol, fm.total_liabilities FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Technology' AND fm.date = CURRENT_DATE;"
Q0718,Simple Retrieval,Look up the headquarters location for Cisco.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'CSCO';"
Q0719,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.64%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.64/100.0) AND fm.date = CURRENT_DATE;
Q0720,Aggregation,Calculate the standard deviation of P/E Ratio for Technology stocks.,SELECT STDDEV(pe_ratio) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0721,Temporal Filtering,Show the historical trajectory of Microsoft's closing prices over the past 7 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'MSFT' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date ASC;"
Q0722,Simple Retrieval,When did Tesla go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'TSLA';
Q0723,Temporal Filtering,Find the specific date when Coca-Cola hit its highest price during the last 30 days.,SELECT date FROM stock_prices WHERE symbol = 'KO' AND date >= CURRENT_DATE - INTERVAL '1 month' ORDER BY high DESC LIMIT 1;
Q0724,Nested/Complex Logic,Find Consumer Defensive companies whose ROA is strictly greater than the sector's average ROA.,"WITH SectorAvg AS (SELECT AVG(roa) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.roa FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.roa > sa.avg_val;"
Q0725,Simple Retrieval,List all companies classified under the Communication Services sector.,"SELECT name, symbol FROM companies WHERE sector = 'Communication Services' ORDER BY name ASC;"
Q0726,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 15 Consumer Cyclical market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 15;"
Q0727,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.52%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.52/100.0) AND fm.date = CURRENT_DATE;
Q0728,Simple Retrieval,Can you find the headquarters location for Apple.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'AAPL';"
Q0729,Nested/Complex Logic,Show Energy stocks exhibiting aggressive growth where this year's ROI exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Energy' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.roi > (prev.roi * 1.20);
Q0730,Temporal Filtering,Did Visa report a positive return on equity in the year 2021?,SELECT CASE WHEN roe > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'V' AND year = 2021;
Q0731,Nested/Complex Logic,Find Healthcare companies whose Beta is strictly greater than the sector's average Beta.,"WITH SectorAvg AS (SELECT AVG(beta) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.beta FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.beta > sa.avg_val;"
Q0732,Multi-table Join,Query the closing prices and latest Gross Margin for companies in the Communication Services sector.,"SELECT c.name, sp.close, fs.gross_margin FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0733,Aggregation,Find the minimum Free Cash Flow reported amongst all tracked equities.,SELECT MIN(free_cash_flow) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0734,Simple Retrieval,Identify PepsiCo's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'PEP';"
Q0735,Simple Retrieval,Identify Wells Fargo's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'WFC';"
Q0736,Aggregation,Find the minimum Beta reported amongst all tracked equities.,SELECT MIN(beta) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0737,Simple Retrieval,When did Abbott Labs go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'ABT';
Q0738,Temporal Filtering,Look up the Alpha for Eli Lilly for the full fiscal year 2023?,SELECT alpha FROM financial_statements WHERE symbol = 'LLY' AND period = 'FY' AND year = 2023;
Q0739,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.09%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.09/100.0) AND fm.date = CURRENT_DATE;
Q0740,Multi-table Join,"List the top 15 Consumer Cyclical stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Cyclical' ORDER BY c.market_cap DESC LIMIT 15;"
Q0741,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.57 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.57 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0742,Nested/Complex Logic,Show Energy stocks exhibiting aggressive growth where this year's EBITDA exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Energy' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.ebitda > (prev.ebitda * 1.20);
Q0743,Temporal Filtering,Find the specific date when Mastercard hit its highest price in the year 2021.,SELECT date FROM stock_prices WHERE symbol = 'MA' AND year = 2021 ORDER BY high DESC LIMIT 1;
Q0744,Aggregation,Determine the median FCF for companies within the Financials sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY free_cash_flow) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials';
Q0745,Temporal Filtering,Fetch the maximum daily trading volume for COST for the full fiscal year 2023.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'COST' AND period = 'FY' AND year = 2023;
Q0746,Multi-table Join,Look up the closing prices and latest P/E Ratio for companies in the Healthcare sector.,"SELECT c.name, sp.close, fs.pe_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0747,Temporal Filtering,Identify the maximum daily trading volume for CMCSA in the year 2021.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'CMCSA' AND year = 2021;
Q0748,Temporal Filtering,Show the historical trajectory of Cisco's closing prices for the full fiscal year 2023.,"SELECT date, close FROM stock_prices WHERE symbol = 'CSCO' AND period = 'FY' AND year = 2023 ORDER BY date ASC;"
Q0749,Multi-table Join,Join company profiles with stock performance to find Financials stock returns year-to-date.,"SELECT c.name, (sp_curr.close - sp_start.close)/sp_start.close as ytd_return FROM companies c JOIN stock_prices sp_curr ON c.symbol = sp_curr.symbol JOIN stock_prices sp_start ON c.symbol = sp_start.symbol WHERE c.sector = 'Financials' AND sp_curr.date = CURRENT_DATE AND sp_start.date = DATE_TRUNC('year', CURRENT_DATE);"
Q0750,Simple Retrieval,Return the official company website for MA.,SELECT website_url FROM company_profiles WHERE symbol = 'MA';
Q0751,Temporal Filtering,List the Debt-to-Equity for Comcast during the fourth quarter of 2022?,SELECT debt_to_equity FROM financial_statements WHERE symbol = 'CMCSA' AND period = 'Q4' AND year = 2022;
Q0752,Temporal Filtering,Query the maximum daily trading volume for MSFT TTM.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'MSFT' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0753,Multi-table Join,I need the closing prices and latest Free Cash Flow for companies in the Energy sector.,"SELECT c.name, sp.close, fs.free_cash_flow FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0754,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.68%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.68/100.0) AND fm.date = CURRENT_DATE;
Q0755,Temporal Filtering,Find the specific date when JPMorgan Chase hit its highest price over the past 7 days.,SELECT date FROM stock_prices WHERE symbol = 'JPM' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY high DESC LIMIT 1;
Q0756,Aggregation,Calculate the average current ratio across all Technology companies.,SELECT AVG(fm.current_ratio) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Technology';
Q0757,Simple Retrieval,Determine the market capitalization of PG.,SELECT market_cap FROM companies WHERE symbol = 'PG';
Q0758,Aggregation,Calculate the average free cash flow across all Communication Services companies.,SELECT AVG(fm.free_cash_flow) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0759,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Disney.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'DIS' AND date = CURRENT_DATE;
Q0760,Simple Retrieval,When did AbbVie go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'ABBV';
Q0761,Nested/Complex Logic,Find Communication Services companies whose Current Ratio is strictly greater than the sector's average Current Ratio.,"WITH SectorAvg AS (SELECT AVG(current_ratio) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.current_ratio FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.current_ratio > sa.avg_val;"
Q0762,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.74%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.74/100.0) AND fm.date = CURRENT_DATE;
Q0763,Nested/Complex Logic,Find Financials companies whose Revenue is strictly greater than the sector's average Revenue.,"WITH SectorAvg AS (SELECT AVG(revenue) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.revenue FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.revenue > sa.avg_val;"
Q0764,Temporal Filtering,Find the specific date when Meta Platforms hit its highest price YTD.,"SELECT date FROM stock_prices WHERE symbol = 'META' AND date >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY high DESC LIMIT 1;"
Q0765,Multi-table Join,Join company profiles with stock performance to find Technology stock returns year-to-date.,"SELECT c.name, (sp_curr.close - sp_start.close)/sp_start.close as ytd_return FROM companies c JOIN stock_prices sp_curr ON c.symbol = sp_curr.symbol JOIN stock_prices sp_start ON c.symbol = sp_start.symbol WHERE c.sector = 'Technology' AND sp_curr.date = CURRENT_DATE AND sp_start.date = DATE_TRUNC('year', CURRENT_DATE);"
Q0766,Multi-table Join,Please display the closing prices and latest Total Assets for companies in the Communication Services sector.,"SELECT c.name, sp.close, fs.total_assets FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0767,Nested/Complex Logic,Identify the single company with the highest Total Liabilities across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.total_liabilities, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.total_liabilities DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, total_liabilities FROM RankedData WHERE rank_id = 1;"
Q0768,Multi-table Join,"List the top 5 Technology stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Technology' ORDER BY c.market_cap DESC LIMIT 5;"
Q0769,Aggregation,Count the number of stocks where the ROI exceeds 100.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE roi > 100;
Q0770,Simple Retrieval,How many employees work at Merck?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'MRK';
Q0771,Temporal Filtering,Show the historical trajectory of Johnson & Johnson's closing prices in the first quarter of last year.,"SELECT date, close FROM stock_prices WHERE symbol = 'JNJ' AND period = 'Q1' AND year = 2023 ORDER BY date ASC;"
Q0772,Temporal Filtering,Calculate the Quick Ratio for Costco in the first quarter of last year?,SELECT quick_ratio FROM financial_statements WHERE symbol = 'COST' AND period = 'Q1' AND year = 2023;
Q0773,Simple Retrieval,When did Accenture go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'ACN';
Q0774,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 5 Financials market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 5;"
Q0775,Simple Retrieval,Can you find the market capitalization of MRK.,SELECT market_cap FROM companies WHERE symbol = 'MRK';
Q0776,Temporal Filtering,Show me the EBITDA for McDonald's for the full fiscal year 2023?,SELECT ebitda FROM financial_statements WHERE symbol = 'MCD' AND period = 'FY' AND year = 2023;
Q0777,Nested/Complex Logic,Show Energy stocks exhibiting aggressive growth where this year's Beta exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Energy' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.beta > (prev.beta * 1.20);
Q0778,Aggregation,Determine the median price-to-earnings for companies within the Technology sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY pe_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology';
Q0779,Multi-table Join,Join company profiles with stock performance to find Consumer Cyclical stock returns year-to-date.,"SELECT c.name, (sp_curr.close - sp_start.close)/sp_start.close as ytd_return FROM companies c JOIN stock_prices sp_curr ON c.symbol = sp_curr.symbol JOIN stock_prices sp_start ON c.symbol = sp_start.symbol WHERE c.sector = 'Consumer Cyclical' AND sp_curr.date = CURRENT_DATE AND sp_start.date = DATE_TRUNC('year', CURRENT_DATE);"
Q0780,Simple Retrieval,How many employees work at Meta Platforms?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'META';
Q0781,Simple Retrieval,Could you provide the closing stock price for Verizon?,SELECT close FROM stock_prices WHERE symbol = 'VZ' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'VZ');
Q0782,Aggregation,Calculate the standard deviation of Payout Ratio for Healthcare stocks.,SELECT STDDEV(payout_ratio) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0783,Multi-table Join,Get the closing prices and latest EPS for companies in the Energy sector.,"SELECT c.name, sp.close, fs.eps FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0784,Aggregation,What is the total distinct count of industries in the Healthcare sector?,SELECT COUNT(DISTINCT industry) FROM companies WHERE sector = 'Healthcare';
Q0785,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 50 Financials market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 50;"
Q0786,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average ROI.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.roi > (SELECT AVG(roi) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0787,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Nvidia.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'NVDA' AND date = CURRENT_DATE;
Q0788,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.39%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.39/100.0) AND fm.date = CURRENT_DATE;
Q0789,Temporal Filtering,Show the historical trajectory of Amazon's closing prices over the past 7 days.,"SELECT date, close FROM stock_prices WHERE symbol = 'AMZN' AND date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date ASC;"
Q0790,Nested/Complex Logic,Show Financials stocks exhibiting aggressive growth where this year's P/E Ratio exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Financials' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.pe_ratio > (prev.pe_ratio * 1.20);
Q0791,Aggregation,Determine the maximum recorded stock price in the Consumer Cyclical sector today.,SELECT MAX(sp.high) as max_price FROM stock_prices sp JOIN companies c ON sp.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE;
Q0792,Temporal Filtering,Extract the maximum daily trading volume for V TTM.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'V' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0793,Nested/Complex Logic,Find the percentage contribution of each Financials company's ROE to the total sector ROE.,"SELECT c.name, (fs.roe * 100.0 / SUM(fs.roe) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Financials' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0794,Nested/Complex Logic,Find Consumer Defensive companies whose Total Liabilities is strictly greater than the sector's average Total Liabilities.,"WITH SectorAvg AS (SELECT AVG(total_liabilities) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.total_liabilities FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.total_liabilities > sa.avg_val;"
Q0795,Temporal Filtering,Show the historical trajectory of Chevron's closing prices in the year 2021.,"SELECT date, close FROM stock_prices WHERE symbol = 'CVX' AND year = 2021 ORDER BY date ASC;"
Q0796,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.61%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.61/100.0) AND fm.date = CURRENT_DATE;
Q0797,Simple Retrieval,I need the closing stock price for Procter & Gamble?,SELECT close FROM stock_prices WHERE symbol = 'PG' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'PG');
Q0798,Temporal Filtering,Please display the Dividend Yield for Tesla YTD?,"SELECT dividend_yield FROM financial_statements WHERE symbol = 'TSLA' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0799,Simple Retrieval,When did Texas Instruments go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'TXN';
Q0800,Simple Retrieval,Get the headquarters location for Berkshire Hathaway.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'BRK.B';"
Q0801,Temporal Filtering,Could you provide the maximum daily trading volume for COST YTD.,"SELECT MAX(volume) FROM stock_prices WHERE symbol = 'COST' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0802,Aggregation,Determine the median operating profit for companies within the Consumer Cyclical sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY ebitda) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0803,Multi-table Join,"I need the names, ticker symbols, and current Total Liabilities for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.total_liabilities FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0804,Aggregation,Calculate the average gross margin across all Energy companies.,SELECT AVG(fm.gross_margin) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0805,Temporal Filtering,Query the Payout Ratio for Johnson & Johnson TTM?,SELECT payout_ratio FROM financial_statements WHERE symbol = 'JNJ' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0806,Nested/Complex Logic,Find the percentage contribution of each Energy company's Operating Margin to the total sector Operating Margin.,"SELECT c.name, (fs.operating_margin * 100.0 / SUM(fs.operating_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0807,Temporal Filtering,Find the specific date when Exxon Mobil hit its highest price TTM.,SELECT date FROM stock_prices WHERE symbol = 'XOM' AND date >= CURRENT_DATE - INTERVAL '1 year' ORDER BY high DESC LIMIT 1;
Q0808,Multi-table Join,"List the top 15 Technology stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Technology' ORDER BY c.market_cap DESC LIMIT 15;"
Q0809,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.12%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.12/100.0) AND fm.date = CURRENT_DATE;
Q0810,Simple Retrieval,When did Broadcom go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'AVGO';
Q0811,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 1.19 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 1.19 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0812,Aggregation,Could you provide the maximum recorded stock price in the Energy sector today.,SELECT MAX(sp.high) as max_price FROM stock_prices sp JOIN companies c ON sp.symbol = c.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE;
Q0813,Temporal Filtering,Show the historical trajectory of AbbVie's closing prices in the year 2021.,"SELECT date, close FROM stock_prices WHERE symbol = 'ABBV' AND year = 2021 ORDER BY date ASC;"
Q0814,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 1.34%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (1.34/100.0) AND fm.date = CURRENT_DATE;
Q0815,Simple Retrieval,I need the closing stock price for Apple?,SELECT close FROM stock_prices WHERE symbol = 'AAPL' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'AAPL');
Q0816,Nested/Complex Logic,Identify the single company with the highest Alpha across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.alpha, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.alpha DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, alpha FROM RankedData WHERE rank_id = 1;"
Q0817,Simple Retrieval,Retrieve the official company website for WMT.,SELECT website_url FROM company_profiles WHERE symbol = 'WMT';
Q0818,Aggregation,Find the minimum Revenue reported amongst all tracked equities.,SELECT MIN(revenue) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0819,Simple Retrieval,Calculate the closing stock price for Coca-Cola?,SELECT close FROM stock_prices WHERE symbol = 'KO' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'KO');
Q0820,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 15 Technology market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 15;"
Q0821,Nested/Complex Logic,Find the percentage contribution of each Communication Services company's ROA to the total sector ROA.,"SELECT c.name, (fs.roa * 100.0 / SUM(fs.roa) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0822,Nested/Complex Logic,Find the percentage contribution of each Communication Services company's Operating Margin to the total sector Operating Margin.,"SELECT c.name, (fs.operating_margin * 100.0 / SUM(fs.operating_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0823,Simple Retrieval,Who is the Chief Executive Officer of AbbVie?,SELECT ceo_name FROM company_profiles WHERE symbol = 'ABBV';
Q0824,Nested/Complex Logic,Find Consumer Cyclical companies whose ROI is strictly greater than the sector's average ROI.,"WITH SectorAvg AS (SELECT AVG(roi) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.roi FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.roi > sa.avg_val;"
Q0825,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's Operating Margin to the total sector Operating Margin.,"SELECT c.name, (fs.operating_margin * 100.0 / SUM(fs.operating_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0826,Temporal Filtering,Find the specific date when Merck hit its highest price for the full fiscal year 2023.,SELECT date FROM stock_prices WHERE symbol = 'MRK' AND period = 'FY' AND year = 2023 ORDER BY high DESC LIMIT 1;
Q0827,Aggregation,Determine the median operating profit for companies within the Communication Services sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY ebitda) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0828,Aggregation,What is the total sum of revenue for the Technology sector?,SELECT SUM(fs.revenue) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0829,Simple Retrieval,Identify the headquarters location for Alphabet.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'GOOG';"
Q0830,Simple Retrieval,Can you find the official company website for MRK.,SELECT website_url FROM company_profiles WHERE symbol = 'MRK';
Q0831,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 2.11 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 2.11 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0832,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.6%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.6/100.0) AND fm.date = CURRENT_DATE;
Q0833,Aggregation,Find the minimum Net Income reported amongst all tracked equities.,SELECT MIN(net_income) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0834,Nested/Complex Logic,Find Healthcare companies whose Alpha is strictly greater than the sector's average Alpha.,"WITH SectorAvg AS (SELECT AVG(alpha) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.alpha FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.alpha > sa.avg_val;"
Q0835,Multi-table Join,Join company profiles with stock performance to find Communication Services stock returns year-to-date.,"SELECT c.name, (sp_curr.close - sp_start.close)/sp_start.close as ytd_return FROM companies c JOIN stock_prices sp_curr ON c.symbol = sp_curr.symbol JOIN stock_prices sp_start ON c.symbol = sp_start.symbol WHERE c.sector = 'Communication Services' AND sp_curr.date = CURRENT_DATE AND sp_start.date = DATE_TRUNC('year', CURRENT_DATE);"
Q0836,Nested/Complex Logic,Find Healthcare companies whose EPS is strictly greater than the sector's average EPS.,"WITH SectorAvg AS (SELECT AVG(eps) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.eps FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.eps > sa.avg_val;"
Q0837,Aggregation,Determine the median net margin for companies within the Energy sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY profit_margin) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Energy';
Q0838,Temporal Filtering,Query the maximum daily trading volume for TXN during the fourth quarter of 2022.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'TXN' AND period = 'Q4' AND year = 2022;
Q0839,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Debt-to-Equity exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.debt_to_equity > (prev.debt_to_equity * 1.20);
Q0840,Nested/Complex Logic,Find the percentage contribution of each Technology company's Total Liabilities to the total sector Total Liabilities.,"SELECT c.name, (fs.total_liabilities * 100.0 / SUM(fs.total_liabilities) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0841,Temporal Filtering,I'd like to see the maximum daily trading volume for ABT during the last 30 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'ABT' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0842,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 15 Healthcare market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 15;"
Q0843,Multi-table Join,What is the closing prices and latest P/E Ratio for companies in the Technology sector.,"SELECT c.name, sp.close, fs.pe_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0844,Aggregation,Count the number of stocks where the Operating Margin exceeds 20.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE operating_margin > 20;
Q0845,Aggregation,What is the total sum of quick ratio for the Communication Services sector?,SELECT SUM(fs.quick_ratio) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0846,Simple Retrieval,Who is the Chief Executive Officer of Accenture?,SELECT ceo_name FROM company_profiles WHERE symbol = 'ACN';
Q0847,Simple Retrieval,How many employees work at Accenture?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'ACN';
Q0848,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.21 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.21 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0849,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 0.89 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 0.89 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0850,Multi-table Join,"Query the names, ticker symbols, and current EBITDA for all Healthcare companies.","SELECT c.name, c.symbol, fm.ebitda FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Healthcare' AND fm.date = CURRENT_DATE;"
Q0851,Simple Retrieval,How many employees work at Amgen?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'AMGN';
Q0852,Aggregation,Find the minimum EPS reported amongst all tracked equities.,SELECT MIN(eps) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0853,Simple Retrieval,List all companies classified under the Energy sector.,"SELECT name, symbol FROM companies WHERE sector = 'Energy' ORDER BY name ASC;"
Q0854,Nested/Complex Logic,Show Consumer Defensive stocks exhibiting aggressive growth where this year's Dividend Yield exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Defensive' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.dividend_yield > (prev.dividend_yield * 1.20);
Q0855,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 20 Consumer Cyclical market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 20;"
Q0856,Aggregation,Calculate the average free cash flow across all Consumer Cyclical companies.,SELECT AVG(fm.free_cash_flow) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0857,Temporal Filtering,I'd like to see the ROA for PepsiCo for the full fiscal year 2023?,SELECT roa FROM financial_statements WHERE symbol = 'PEP' AND period = 'FY' AND year = 2023;
Q0858,Aggregation,Count the number of stocks where the Payout Ratio exceeds 50.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE payout_ratio > 50;
Q0859,Multi-table Join,"List the top 3 Healthcare stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Healthcare' ORDER BY c.market_cap DESC LIMIT 3;"
Q0860,Aggregation,Determine the median asset base for companies within the Healthcare sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_assets) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0861,Aggregation,Count the number of stocks where the ROA exceeds 25.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE roa > 25;
Q0862,Nested/Complex Logic,Show Energy stocks exhibiting aggressive growth where this year's EPS exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Energy' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.eps > (prev.eps * 1.20);
Q0863,Simple Retrieval,Generate a report showing the closing stock price for Accenture?,SELECT close FROM stock_prices WHERE symbol = 'ACN' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'ACN');
Q0864,Nested/Complex Logic,Find the percentage contribution of each Consumer Cyclical company's ROE to the total sector ROE.,"SELECT c.name, (fs.roe * 100.0 / SUM(fs.roe) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0865,Temporal Filtering,Did PepsiCo report a positive bottom line in the first quarter of last year?,SELECT CASE WHEN net_income > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'PEP' AND period = 'Q1' AND year = 2023;
Q0866,Aggregation,Determine the median return on assets for companies within the Consumer Defensive sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY roa) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Defensive';
Q0867,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 50 Energy market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 50;"
Q0868,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Tesla.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'TSLA' AND date = CURRENT_DATE;
Q0869,Aggregation,Count the number of stocks where the Net Income exceeds 15.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE net_income > 15;
Q0870,Simple Retrieval,Calculate the market capitalization of VZ.,SELECT market_cap FROM companies WHERE symbol = 'VZ';
Q0871,Aggregation,Determine the median dividend payout for companies within the Technology sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY payout_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology';
Q0872,Multi-table Join,"Determine the names, ticker symbols, and current Gross Margin for all Energy companies.","SELECT c.name, c.symbol, fm.gross_margin FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Energy' AND fm.date = CURRENT_DATE;"
Q0873,Temporal Filtering,Show the historical trajectory of Coca-Cola's closing prices in the year 2021.,"SELECT date, close FROM stock_prices WHERE symbol = 'KO' AND year = 2021 ORDER BY date ASC;"
Q0874,Aggregation,Show me the maximum recorded stock price in the Healthcare sector today.,SELECT MAX(sp.high) as max_price FROM stock_prices sp JOIN companies c ON sp.symbol = c.symbol WHERE c.sector = 'Healthcare' AND sp.date = CURRENT_DATE;
Q0875,Temporal Filtering,Find the specific date when Comcast hit its highest price during the last 30 days.,SELECT date FROM stock_prices WHERE symbol = 'CMCSA' AND date >= CURRENT_DATE - INTERVAL '1 month' ORDER BY high DESC LIMIT 1;
Q0876,Multi-table Join,"Show me the names, ticker symbols, and current Free Cash Flow for all Communication Services companies.","SELECT c.name, c.symbol, fm.free_cash_flow FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0877,Temporal Filtering,Did Cisco report a positive FCF YTD?,"SELECT CASE WHEN free_cash_flow > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'CSCO' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0878,Simple Retrieval,Show me the closing stock price for Amazon?,SELECT close FROM stock_prices WHERE symbol = 'AMZN' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'AMZN');
Q0879,Multi-table Join,"Look up the names, ticker symbols, and current Free Cash Flow for all Financials companies.","SELECT c.name, c.symbol, fm.free_cash_flow FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0880,Simple Retrieval,I need the closing stock price for Costco?,SELECT close FROM stock_prices WHERE symbol = 'COST' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'COST');
Q0881,Nested/Complex Logic,Find the percentage contribution of each Technology company's Net Income to the total sector Net Income.,"SELECT c.name, (fs.net_income * 100.0 / SUM(fs.net_income) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0882,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Net Income exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.net_income > (prev.net_income * 1.20);
Q0883,Simple Retrieval,Identify Danaher's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'DHR';"
Q0884,Aggregation,What is the total sum of roe for the Consumer Cyclical sector?,SELECT SUM(fs.roe) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0885,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 10 Healthcare market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 10;"
Q0886,Temporal Filtering,Did Wells Fargo report a positive total debt in the year 2021?,SELECT CASE WHEN total_liabilities > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'WFC' AND year = 2021;
Q0887,Temporal Filtering,Find the specific date when Eli Lilly hit its highest price TTM.,SELECT date FROM stock_prices WHERE symbol = 'LLY' AND date >= CURRENT_DATE - INTERVAL '1 year' ORDER BY high DESC LIMIT 1;
Q0888,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 15 Consumer Defensive market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 15;"
Q0889,Simple Retrieval,Generate a report showing the headquarters location for Merck.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'MRK';"
Q0890,Nested/Complex Logic,Identify the single company with the highest Free Cash Flow across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.free_cash_flow, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.free_cash_flow DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, free_cash_flow FROM RankedData WHERE rank_id = 1;"
Q0891,Multi-table Join,"I'd like to see the names, ticker symbols, and current Dividend Yield for all Financials companies.","SELECT c.name, c.symbol, fm.dividend_yield FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0892,Aggregation,Calculate the standard deviation of Alpha for Energy stocks.,SELECT STDDEV(alpha) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0893,Temporal Filtering,Query the Gross Margin for Mastercard TTM?,SELECT gross_margin FROM financial_statements WHERE symbol = 'MA' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0894,Temporal Filtering,What is the Current Ratio for Nike YTD?,"SELECT current_ratio FROM financial_statements WHERE symbol = 'NKE' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0895,Multi-table Join,Join company profiles with stock performance to find Healthcare stock returns year-to-date.,"SELECT c.name, (sp_curr.close - sp_start.close)/sp_start.close as ytd_return FROM companies c JOIN stock_prices sp_curr ON c.symbol = sp_curr.symbol JOIN stock_prices sp_start ON c.symbol = sp_start.symbol WHERE c.sector = 'Healthcare' AND sp_curr.date = CURRENT_DATE AND sp_start.date = DATE_TRUNC('year', CURRENT_DATE);"
Q0896,Multi-table Join,Generate a report showing the closing prices and latest Dividend Yield for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.dividend_yield FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0897,Nested/Complex Logic,Find the percentage contribution of each Consumer Defensive company's Free Cash Flow to the total sector Free Cash Flow.,"SELECT c.name, (fs.free_cash_flow * 100.0 / SUM(fs.free_cash_flow) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0898,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Eli Lilly.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'LLY' AND date = CURRENT_DATE;
Q0899,Aggregation,What is the total distinct count of industries in the Energy sector?,SELECT COUNT(DISTINCT industry) FROM companies WHERE sector = 'Energy';
Q0900,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 4.35%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (4.35/100.0) AND fm.date = CURRENT_DATE;
Q0901,Multi-table Join,Look up the closing prices and latest Current Ratio for companies in the Energy sector.,"SELECT c.name, sp.close, fs.current_ratio FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0902,Multi-table Join,"List the names, ticker symbols, and current Profit Margin for all Consumer Defensive companies.","SELECT c.name, c.symbol, fm.profit_margin FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Defensive' AND fm.date = CURRENT_DATE;"
Q0903,Simple Retrieval,Who is the Chief Executive Officer of Alphabet?,SELECT ceo_name FROM company_profiles WHERE symbol = 'GOOG';
Q0904,Multi-table Join,"Determine the names, ticker symbols, and current Debt-to-Equity for all Communication Services companies.","SELECT c.name, c.symbol, fm.debt_to_equity FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0905,Nested/Complex Logic,Show Technology stocks exhibiting aggressive growth where this year's Dividend Yield exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Technology' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.dividend_yield > (prev.dividend_yield * 1.20);
Q0906,Temporal Filtering,Get the Total Assets for Chevron in the first quarter of last year?,SELECT total_assets FROM financial_statements WHERE symbol = 'CVX' AND period = 'Q1' AND year = 2023;
Q0907,Temporal Filtering,Did Costco report a positive price-to-earnings during the last 30 days?,SELECT CASE WHEN pe_ratio > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'COST' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0908,Simple Retrieval,Show me the closing stock price for Thermo Fisher?,SELECT close FROM stock_prices WHERE symbol = 'TMO' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'TMO');
Q0909,Simple Retrieval,How many employees work at JPMorgan Chase?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'JPM';
Q0910,Temporal Filtering,Determine the maximum daily trading volume for AMZN during the last 30 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'AMZN' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0911,Nested/Complex Logic,Find the percentage contribution of each Communication Services company's Total Assets to the total sector Total Assets.,"SELECT c.name, (fs.total_assets * 100.0 / SUM(fs.total_assets) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0912,Simple Retrieval,I'd like to see the official company website for TSLA.,SELECT website_url FROM company_profiles WHERE symbol = 'TSLA';
Q0913,Simple Retrieval,Identify Mastercard's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'MA';"
Q0914,Aggregation,Calculate the standard deviation of ROA for Energy stocks.,SELECT STDDEV(roa) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Energy';
Q0915,Simple Retrieval,How many employees work at AbbVie?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'ABBV';
Q0916,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.21%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.21/100.0) AND fm.date = CURRENT_DATE;
Q0917,Simple Retrieval,Who is the Chief Executive Officer of Verizon?,SELECT ceo_name FROM company_profiles WHERE symbol = 'VZ';
Q0918,Aggregation,Find the minimum EBITDA reported amongst all tracked equities.,SELECT MIN(ebitda) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0919,Aggregation,Find the minimum Current Ratio reported amongst all tracked equities.,SELECT MIN(current_ratio) as min_val FROM financial_metrics WHERE date = CURRENT_DATE;
Q0920,Multi-table Join,"List the top 3 Technology stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Technology' ORDER BY c.market_cap DESC LIMIT 3;"
Q0921,Domain-Specific Financial Phrasing,Identify potential value traps where the P/E ratio is below 10 but year-over-year revenue is declining.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements curr ON c.symbol = curr.symbol JOIN financial_statements prev ON c.symbol = prev.symbol WHERE fm.pe_ratio < 10.0 AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.revenue < prev.revenue;
Q0922,Nested/Complex Logic,Identify the single company with the highest Current Ratio across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.current_ratio, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.current_ratio DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, current_ratio FROM RankedData WHERE rank_id = 1;"
Q0923,Aggregation,Calculate the average total assets across all Healthcare companies.,SELECT AVG(fm.total_assets) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Healthcare';
Q0924,Aggregation,Calculate the average payout ratio across all Consumer Defensive companies.,SELECT AVG(fm.payout_ratio) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Defensive';
Q0925,Multi-table Join,Return the closing prices and latest ROA for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.roa FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0926,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 0.9%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (0.9/100.0) AND fm.date = CURRENT_DATE;
Q0927,Multi-table Join,"I'd like to see the names, ticker symbols, and current ROE for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.roe FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0928,Temporal Filtering,Can you find the maximum daily trading volume for JNJ during the last 30 days.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'JNJ' AND date >= CURRENT_DATE - INTERVAL '1 month';
Q0929,Multi-table Join,Could you provide the closing prices and latest Total Liabilities for companies in the Technology sector.,"SELECT c.name, sp.close, fs.total_liabilities FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0930,Simple Retrieval,How many employees work at Eli Lilly?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'LLY';
Q0931,Simple Retrieval,Identify Broadcom's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'AVGO';"
Q0932,Simple Retrieval,I'd like to see the headquarters location for Microsoft.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'MSFT';"
Q0933,Multi-table Join,"List the top 10 Consumer Cyclical stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Cyclical' ORDER BY c.market_cap DESC LIMIT 10;"
Q0934,Nested/Complex Logic,Show Healthcare stocks exhibiting aggressive growth where this year's Total Assets exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Healthcare' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.total_assets > (prev.total_assets * 1.20);
Q0935,Temporal Filtering,Return the maximum daily trading volume for AMZN TTM.,SELECT MAX(volume) FROM stock_prices WHERE symbol = 'AMZN' AND date >= CURRENT_DATE - INTERVAL '1 year';
Q0936,Nested/Complex Logic,List equities that are currently trading below their 52-week moving average but possess above-average Debt-to-Equity.,SELECT c.name FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE sp.date = CURRENT_DATE AND sp.close < (SELECT AVG(close) FROM stock_prices WHERE symbol = c.symbol AND date >= CURRENT_DATE - INTERVAL '1 year') AND fm.debt_to_equity > (SELECT AVG(debt_to_equity) FROM financial_metrics WHERE date = CURRENT_DATE);
Q0937,Temporal Filtering,Please display the Forward P/E for Nike YTD?,"SELECT forward_pe FROM financial_statements WHERE symbol = 'NKE' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0938,Simple Retrieval,List all companies classified under the Technology sector.,"SELECT name, symbol FROM companies WHERE sector = 'Technology' ORDER BY name ASC;"
Q0939,Simple Retrieval,Retrieve the market capitalization of NVDA.,SELECT market_cap FROM companies WHERE symbol = 'NVDA';
Q0940,Nested/Complex Logic,Show Consumer Cyclical stocks exhibiting aggressive growth where this year's Total Liabilities exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.total_liabilities > (prev.total_liabilities * 1.20);
Q0941,Aggregation,What is the total sum of profit margin for the Technology sector?,SELECT SUM(fs.profit_margin) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0942,Simple Retrieval,How many employees work at Wells Fargo?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'WFC';
Q0943,Simple Retrieval,How many employees work at Procter & Gamble?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'PG';
Q0944,Temporal Filtering,Did Eli Lilly report a positive D/E ratio for the full fiscal year 2023?,SELECT CASE WHEN debt_to_equity > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'LLY' AND period = 'FY' AND year = 2023;
Q0945,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Danaher.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'DHR' AND date = CURRENT_DATE;
Q0946,Multi-table Join,"Identify the names, ticker symbols, and current ROA for all Consumer Defensive companies.","SELECT c.name, c.symbol, fm.roa FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Defensive' AND fm.date = CURRENT_DATE;"
Q0947,Simple Retrieval,When did Visa go public?,SELECT ipo_date FROM company_profiles WHERE symbol = 'V';
Q0948,Multi-table Join,Fetch the closing prices and latest Forward P/E for companies in the Technology sector.,"SELECT c.name, sp.close, fs.forward_pe FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Technology' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0949,Multi-table Join,"Generate a report showing the names, ticker symbols, and current P/E Ratio for all Communication Services companies.","SELECT c.name, c.symbol, fm.pe_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Communication Services' AND fm.date = CURRENT_DATE;"
Q0950,Simple Retrieval,How many employees work at Amazon?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'AMZN';
Q0951,Temporal Filtering,Did Thermo Fisher report a positive price-to-earnings YTD?,"SELECT CASE WHEN pe_ratio > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'TMO' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0952,Aggregation,Calculate the average p/e ratio across all Consumer Cyclical companies.,SELECT AVG(fm.pe_ratio) as avg_metric FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Consumer Cyclical';
Q0953,Simple Retrieval,Calculate the ticker symbol associated with Merck.,SELECT symbol FROM companies WHERE name ILIKE 'Merck%';
Q0954,Temporal Filtering,Find the specific date when Cisco hit its highest price during the fourth quarter of 2022.,SELECT date FROM stock_prices WHERE symbol = 'CSCO' AND period = 'Q4' AND year = 2022 ORDER BY high DESC LIMIT 1;
Q0955,Simple Retrieval,List all companies classified under the Healthcare sector.,"SELECT name, symbol FROM companies WHERE sector = 'Healthcare' ORDER BY name ASC;"
Q0956,Nested/Complex Logic,Find the percentage contribution of each Energy company's Revenue to the total sector Revenue.,"SELECT c.name, (fs.revenue * 100.0 / SUM(fs.revenue) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0957,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 3.47%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (3.47/100.0) AND fm.date = CURRENT_DATE;
Q0958,Temporal Filtering,Fetch the Revenue for Nike over the past 7 days?,SELECT revenue FROM financial_statements WHERE symbol = 'NKE' AND date >= CURRENT_DATE - INTERVAL '7 days';
Q0959,Nested/Complex Logic,Identify the single company with the highest EPS across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.eps, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.eps DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, eps FROM RankedData WHERE rank_id = 1;"
Q0960,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 20 Consumer Defensive market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Defensive' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 20;"
Q0961,Aggregation,What is the total sum of p/e ratio for the Technology sector?,SELECT SUM(fs.pe_ratio) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0962,Multi-table Join,"Show me the names, ticker symbols, and current P/E Ratio for all Financials companies.","SELECT c.name, c.symbol, fm.pe_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Financials' AND fm.date = CURRENT_DATE;"
Q0963,Simple Retrieval,Determine the official company website for JPM.,SELECT website_url FROM company_profiles WHERE symbol = 'JPM';
Q0964,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 3 Energy market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 3;"
Q0965,Simple Retrieval,Calculate the headquarters location for Johnson & Johnson.,"SELECT hq_city, hq_state, hq_country FROM companies WHERE symbol = 'JNJ';"
Q0966,Aggregation,Count the number of stocks where the Current Ratio exceeds 15.,SELECT COUNT(DISTINCT symbol) as company_count FROM financial_metrics WHERE current_ratio > 15;
Q0967,Domain-Specific Financial Phrasing,Determine the trailing twelve months EBITDA margin for the top 3 Healthcare market leaders.,"SELECT c.name, (fs.ebitda / NULLIF(fs.revenue, 0)) as ebitda_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.period = 'TTM' ORDER BY c.market_cap DESC LIMIT 3;"
Q0968,Nested/Complex Logic,Find the percentage contribution of each Communication Services company's Revenue to the total sector Revenue.,"SELECT c.name, (fs.revenue * 100.0 / SUM(fs.revenue) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0969,Aggregation,Determine the median D/E ratio for companies within the Communication Services sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY debt_to_equity) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0970,Simple Retrieval,Calculate the market capitalization of AVGO.,SELECT market_cap FROM companies WHERE symbol = 'AVGO';
Q0971,Multi-table Join,"Please display the names, ticker symbols, and current Payout Ratio for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.payout_ratio FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0972,Simple Retrieval,Identify AbbVie's primary sector and sub-industry.,"SELECT sector, industry FROM companies WHERE symbol = 'ABBV';"
Q0973,Nested/Complex Logic,Find the percentage contribution of each Energy company's Net Income to the total sector Net Income.,"SELECT c.name, (fs.net_income * 100.0 / SUM(fs.net_income) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0974,Multi-table Join,"List the top 3 Energy stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Energy' ORDER BY c.market_cap DESC LIMIT 3;"
Q0975,Multi-table Join,What is the closing prices and latest EPS for companies in the Consumer Cyclical sector.,"SELECT c.name, sp.close, fs.eps FROM companies c JOIN stock_prices sp ON c.symbol = sp.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Consumer Cyclical' AND sp.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0976,Domain-Specific Financial Phrasing,Filter for fundamentally strong companies with a debt-to-equity ratio under 3.6 and positive free cash flow.,SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fm.debt_to_equity < 3.6 AND fs.free_cash_flow > 0 AND fm.date = CURRENT_DATE AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0977,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for UnitedHealth.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'UNH' AND date = CURRENT_DATE;
Q0978,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 0.71%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (0.71/100.0) AND fm.date = CURRENT_DATE;
Q0979,Aggregation,What is the total sum of net income for the Technology sector?,SELECT SUM(fs.net_income) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0980,Multi-table Join,"List the top 5 Consumer Defensive stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Consumer Defensive' ORDER BY c.market_cap DESC LIMIT 5;"
Q0981,Nested/Complex Logic,Find the percentage contribution of each Healthcare company's Gross Margin to the total sector Gross Margin.,"SELECT c.name, (fs.gross_margin * 100.0 / SUM(fs.gross_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Healthcare' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0982,Nested/Complex Logic,Show Communication Services stocks exhibiting aggressive growth where this year's Forward P/E exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Communication Services' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.forward_pe > (prev.forward_pe * 1.20);
Q0983,Aggregation,What is the total sum of roa for the Communication Services sector?,SELECT SUM(fs.roa) as total_sum FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);
Q0984,Nested/Complex Logic,Identify the single company with the highest Operating Margin across every individual sector.,"WITH RankedData AS (SELECT c.sector, c.name, fs.operating_margin, ROW_NUMBER() OVER(PARTITION BY c.sector ORDER BY fs.operating_margin DESC) as rank_id FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT sector, name, operating_margin FROM RankedData WHERE rank_id = 1;"
Q0985,Domain-Specific Financial Phrasing,"Screen for low volatility, high yield equities: Beta < 0.8 and Dividend Yield > 2.02%.",SELECT c.name FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE fm.beta < 0.8 AND fm.dividend_yield > (2.02/100.0) AND fm.date = CURRENT_DATE;
Q0986,Domain-Specific Financial Phrasing,Calculate the valuation spread referencing forward P/E against trailing P/E for Alphabet.,SELECT (pe_ratio - forward_pe) as pe_spread FROM financial_metrics WHERE symbol = 'GOOG' AND date = CURRENT_DATE;
Q0987,Temporal Filtering,Did Berkshire Hathaway report a positive return on investment YTD?,"SELECT CASE WHEN roi > 0 THEN 'Yes' ELSE 'No' END as is_positive FROM financial_statements WHERE symbol = 'BRK.B' AND date >= DATE_TRUNC('year', CURRENT_DATE);"
Q0988,Simple Retrieval,How many employees work at Exxon Mobil?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'XOM';
Q0989,Nested/Complex Logic,Find Technology companies whose ROE is strictly greater than the sector's average ROE.,"WITH SectorAvg AS (SELECT AVG(roe) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.roe FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Technology' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.roe > sa.avg_val;"
Q0990,Multi-table Join,"Please display the names, ticker symbols, and current Beta for all Consumer Cyclical companies.","SELECT c.name, c.symbol, fm.beta FROM companies c JOIN financial_metrics fm ON c.symbol = fm.symbol WHERE c.sector = 'Consumer Cyclical' AND fm.date = CURRENT_DATE;"
Q0991,Aggregation,Determine the median acid-test ratio for companies within the Communication Services sector.,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY quick_ratio) as median_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0992,Simple Retrieval,Show me the closing stock price for Home Depot?,SELECT close FROM stock_prices WHERE symbol = 'HD' AND date = (SELECT MAX(date) FROM stock_prices WHERE symbol = 'HD');
Q0993,Multi-table Join,"List the top 10 Financials stocks based on their market cap, along with their CEO names.","SELECT c.name, c.market_cap, cp.ceo_name FROM companies c JOIN company_profiles cp ON c.symbol = cp.symbol WHERE c.sector = 'Financials' ORDER BY c.market_cap DESC LIMIT 10;"
Q0994,Aggregation,Calculate the standard deviation of Current Ratio for Communication Services stocks.,SELECT STDDEV(current_ratio) FROM financial_metrics fm JOIN companies c ON fm.symbol = c.symbol WHERE c.sector = 'Communication Services';
Q0995,Nested/Complex Logic,Show Financials stocks exhibiting aggressive growth where this year's Gross Margin exceeds last year's by over 20%.,SELECT curr.symbol FROM financial_statements curr JOIN financial_statements prev ON curr.symbol = prev.symbol JOIN companies c ON curr.symbol = c.symbol WHERE c.sector = 'Financials' AND curr.year = EXTRACT(YEAR FROM CURRENT_DATE) AND prev.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND curr.gross_margin > (prev.gross_margin * 1.20);
Q0996,Nested/Complex Logic,Find the percentage contribution of each Energy company's Gross Margin to the total sector Gross Margin.,"SELECT c.name, (fs.gross_margin * 100.0 / SUM(fs.gross_margin) OVER()) as pct_contribution FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol WHERE c.sector = 'Energy' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE);"
Q0997,Temporal Filtering,List the Dividend Yield for Procter & Gamble for the full fiscal year 2023?,SELECT dividend_yield FROM financial_statements WHERE symbol = 'PG' AND period = 'FY' AND year = 2023;
Q0998,Simple Retrieval,Calculate the ticker symbol associated with Abbott Labs.,SELECT symbol FROM companies WHERE name ILIKE 'Abbott Labs%';
Q0999,Simple Retrieval,How many employees work at McDonald's?,SELECT full_time_employees FROM company_profiles WHERE symbol = 'MCD';
Q1000,Nested/Complex Logic,Find Communication Services companies whose Profit Margin is strictly greater than the sector's average Profit Margin.,"WITH SectorAvg AS (SELECT AVG(profit_margin) as avg_val FROM financial_statements fs JOIN companies c ON fs.symbol = c.symbol WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE)) SELECT c.name, fs.profit_margin FROM companies c JOIN financial_statements fs ON c.symbol = fs.symbol CROSS JOIN SectorAvg sa WHERE c.sector = 'Communication Services' AND fs.year = EXTRACT(YEAR FROM CURRENT_DATE) AND fs.profit_margin > sa.avg_val;"
